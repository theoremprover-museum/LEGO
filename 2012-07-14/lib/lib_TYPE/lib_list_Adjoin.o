Module lib_list_Adjoin Import "lib_list_length";
$[Adjoin : {s|SET}s->(list s)->(list s)->Prop//ad1 ad2];
$[ad1 : {s|SET}{a:s}{xs:list s}Adjoin%%s a xs (cons%%s a xs)];
$[ad2 : {s|SET}{xs|list s}{a|s}{axs|list s}(Adjoin%%s a xs axs)->{b:s}Adjoin%%s a (cons%%s b xs) (cons%%s b axs)];
$[Adjoin_elim : {s|SET}{C_Adjoin:{x1:s}{x2,x3:list s}Prop}({a:s}{xs:list s}C_Adjoin a xs (cons%%s a xs))->({xs|list s}{a|s}{axs|list s}{x1:Adjoin%%s a xs axs}{b:s}{x1_ih:C_Adjoin a xs axs}C_Adjoin a (cons%%s b xs) (cons%%s b axs))->{x1|s}{x2,x3|list s}{z:Adjoin%%s x1 x2 x3}C_Adjoin x1 x2 x3];
Label (!Adjoin!) Adjoin;Label (!Adjoin elim!) Adjoin_elim;Label (!Adjoin ad1!) ad1;Label (!Adjoin ad2!) ad2;[[s|SET][C_Adjoin:s->(list s)->(list s)->Prop][f_ad1:{a1:s}{xs1:list s}C_Adjoin a1 xs1 (cons a1 xs1)][f_ad2:{xs|list s}{a|s}{axs|list s}(Adjoin a xs axs)->{b:s}(C_Adjoin a xs axs)->C_Adjoin a (cons b xs) (cons b axs)][a1:s][xs1:list s][xs|list s][a|s][axs|list s][x1:Adjoin a xs axs][b:s]   Adjoin_elim C_Adjoin f_ad1 f_ad2 (ad1 a1 xs1)  ==>  f_ad1 a1 xs1|| Adjoin_elim C_Adjoin f_ad1 f_ad2 (ad2 x1 b)  ==>  f_ad2 x1 b (Adjoin_elim C_Adjoin f_ad1 f_ad2 x1)]
;
[Adjoin_inv : {s|SET}{a|s}{xs,ys|list s}(Adjoin%%s a xs ys)->(Eq%%(list s) ys (cons%%s a xs) \/ Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c xs') /\ Eq%%(list s) ys (cons%%s c ys') /\ Adjoin%%s a xs' ys')))))
  = [s|SET][a|s][xs,ys|list s][H:Adjoin%%s a xs ys]Adjoin_elim%%s ([a'6:s][xs'7,ys'8:list s](Eq%%(list s) ys'8 (cons%%s a'6 xs'7) \/ Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs'7 (cons%%s c xs') /\ Eq%%(list s) ys'8 (cons%%s c ys') /\ Adjoin%%s a'6 xs' ys')))))) ([a1:s][xs1:list s]inl%%(Eq%%(list s) (cons%%s a1 xs1) (cons%%s a1 xs1))%%(Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs1 (cons%%s c xs') /\ Eq%%(list s) (cons%%s a1 xs1) (cons%%s c ys') /\ Adjoin%%s a1 xs' ys'))))) (Eq_refl%%(list s) (cons%%s a1 xs1))) ([xs1|list s][a1|s][axs|list s][x1:Adjoin%%s a1 xs1 axs][b:s][x1_ih:Eq%%(list s) axs (cons%%s a1 xs1) \/ Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs1 (cons%%s c xs') /\ Eq%%(list s) axs (cons%%s c ys') /\ Adjoin%%s a1 xs' ys'))))]inr%%(Eq%%(list s) (cons%%s b axs) (cons%%s a1 (cons%%s b xs1)))%%(Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (cons%%s b xs1) (cons%%s c xs') /\ Eq%%(list s) (cons%%s b axs) (cons%%s c ys') /\ Adjoin%%s a1 xs' ys'))))) (ExIntro%%(list s) xs1 ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (cons%%s b xs1) (cons%%s c xs') /\ Eq%%(list s) (cons%%s b axs) (cons%%s c ys') /\ Adjoin%%s a1 xs' ys')))) (ExIntro%%(list s) axs ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (cons%%s b xs1) (cons%%s c xs1) /\ Eq%%(list s) (cons%%s b axs) (cons%%s c ys') /\ Adjoin%%s a1 xs1 ys'))) (ExIntro%%s b ([c:s](Eq%%(list s) (cons%%s b xs1) (cons%%s c xs1) /\ Eq%%(list s) (cons%%s b axs) (cons%%s c axs) /\ Adjoin%%s a1 xs1 axs)) (pair%%(Eq%%(list s) (cons%%s b xs1) (cons%%s b xs1) /\ Eq%%(list s) (cons%%s b axs) (cons%%s b axs))%%(Adjoin%%s a1 xs1 axs) (pair%%(Eq%%(list s) (cons%%s b xs1) (cons%%s b xs1))%%(Eq%%(list s) (cons%%s b axs) (cons%%s b axs)) (Eq_refl%%(list s) (cons%%s b xs1)) (Eq_refl%%(list s) (cons%%s b axs))) x1)))))%%a%%xs%%ys H];
[Adjoin_inv_corr1 : {s|SET}{a,b|s}{xs,ys|list s}(Adjoin%%s a (cons%%s b xs) ys)->(Eq%%(list s) ys (cons%%s a (cons%%s b xs)) \/ Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys')))
  = [s|SET][a,b|s][xs,ys|list s][H:Adjoin%%s a (cons%%s b xs) ys]Adjoin_inv%%s%%a%%(cons%%s b xs)%%ys H%%(Eq%%(list s) ys (cons%%s a (cons%%s b xs)) \/ Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) ([H1:Eq%%(list s) ys (cons%%s a (cons%%s b xs))]inl%%(Eq%%(list s) ys (cons%%s a (cons%%s b xs)))%%(Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) H1) ([H1:Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (cons%%s b xs) (cons%%s c xs') /\ Eq%%(list s) ys (cons%%s c ys') /\ Adjoin%%s a xs' ys'))))]inr%%(Eq%%(list s) ys (cons%%s a (cons%%s b xs)))%%(Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) (H1 (Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) ([t:list s][H2:Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (cons%%s b xs) (cons%%s c t) /\ Eq%%(list s) ys (cons%%s c ys') /\ Adjoin%%s a t ys')))]H2 (Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) ([t1:list s][H3:Ex%%s ([c:s](Eq%%(list s) (cons%%s b xs) (cons%%s c t) /\ Eq%%(list s) ys (cons%%s c t1) /\ Adjoin%%s a t t1))]H3 (Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) ([t2:s][H4:Eq%%(list s) (cons%%s b xs) (cons%%s t2 t) /\ Eq%%(list s) ys (cons%%s t2 t1) /\ Adjoin%%s a t t1]H4%%(Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) ([H5:Eq%%(list s) (cons%%s b xs) (cons%%s t2 t) /\ Eq%%(list s) ys (cons%%s t2 t1)][H6:Adjoin%%s a t t1]H5%%(Ex%%(list s) ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys'))) ([H7:Eq%%(list s) (cons%%s b xs) (cons%%s t2 t)][H8:Eq%%(list s) ys (cons%%s t2 t1)]ExIntro%%(list s) t1 ([ys':list s](Eq%%(list s) ys (cons%%s b ys') /\ Adjoin%%s a xs ys')) (cons_inj%%s%%b%%t2%%xs%%t H7%%(Eq%%(list s) ys (cons%%s b t1) /\ Adjoin%%s a xs t1) ([H9:Eq%%s b t2][H10:Eq%%(list s) xs t]pair%%(Eq%%(list s) ys (cons%%s b t1))%%(Adjoin%%s a xs t1) (Eq_subst%%s%%t2%%b (Eq_sym%%s%%b%%t2 H9) ([b'20:s]Eq%%(list s) ys (cons%%s b'20 t1)) H8) (Eq_subst%%(list s)%%t%%xs (Eq_sym%%(list s)%%xs%%t H10) ([xs'20:list s]Adjoin%%s a xs'20 t1) H6))))))))))];
[Adjoin_inv_corr2 : {s|SET}{a,b|s}{xs,ys|list s}(Adjoin%%s a xs (cons%%s b ys))->((Eq%%s a b /\ Eq%%(list s) xs ys) \/ Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys)))
  = [s|SET][a,b|s][xs,ys|list s][H:Adjoin%%s a xs (cons%%s b ys)]Adjoin_inv%%s%%a%%xs%%(cons%%s b ys) H%%((Eq%%s a b /\ Eq%%(list s) xs ys) \/ Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) ([H1:Eq%%(list s) (cons%%s b ys) (cons%%s a xs)]inl%%(Eq%%s a b /\ Eq%%(list s) xs ys)%%(Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) (cons_inj%%s%%b%%a%%ys%%xs H1%%(Eq%%s a b /\ Eq%%(list s) xs ys) ([H2:Eq%%s b a][H3:Eq%%(list s) ys xs]pair%%(Eq%%s a b)%%(Eq%%(list s) xs ys) (Eq_sym%%s%%b%%a H2) (Eq_sym%%(list s)%%ys%%xs H3)))) ([H1:Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c xs') /\ Eq%%(list s) (cons%%s b ys) (cons%%s c ys') /\ Adjoin%%s a xs' ys'))))]inr%%(Eq%%s a b /\ Eq%%(list s) xs ys)%%(Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) (H1 (Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) ([t:list s][H2:Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c t) /\ Eq%%(list s) (cons%%s b ys) (cons%%s c ys') /\ Adjoin%%s a t ys')))]H2 (Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) ([t1:list s][H3:Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c t) /\ Eq%%(list s) (cons%%s b ys) (cons%%s c t1) /\ Adjoin%%s a t t1))]H3 (Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) ([t2:s][H4:Eq%%(list s) xs (cons%%s t2 t) /\ Eq%%(list s) (cons%%s b ys) (cons%%s t2 t1) /\ Adjoin%%s a t t1]H4%%(Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) ([H5:Eq%%(list s) xs (cons%%s t2 t) /\ Eq%%(list s) (cons%%s b ys) (cons%%s t2 t1)][H6:Adjoin%%s a t t1]H5%%(Ex%%(list s) ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys))) ([H7:Eq%%(list s) xs (cons%%s t2 t)][H8:Eq%%(list s) (cons%%s b ys) (cons%%s t2 t1)]ExIntro%%(list s) t ([xs':list s](Eq%%(list s) xs (cons%%s b xs') /\ Adjoin%%s a xs' ys)) (cons_inj%%s%%b%%t2%%ys%%t1 H8%%(Eq%%(list s) xs (cons%%s b t) /\ Adjoin%%s a t ys) ([H9:Eq%%s b t2][H10:Eq%%(list s) ys t1]pair%%(Eq%%(list s) xs (cons%%s b t))%%(Adjoin%%s a t ys) (Eq_subst%%s%%t2%%b (Eq_sym%%s%%b%%t2 H9) ([b'20:s]Eq%%(list s) xs (cons%%s b'20 t)) H7) (Eq_subst%%(list s)%%t1%%ys (Eq_sym%%(list s)%%ys%%t1 H10) (Adjoin%%s a t) H6))))))))))];
[Adjoin_inv_corr3 : {s|SET}{a|s}{xs|list s}(Adjoin%%s a (nil s) xs)->Eq%%(list s) xs (cons%%s a (nil s))
  = [s|SET][a|s][xs|list s][H:Adjoin%%s a (nil s) xs]Adjoin_inv%%s%%a%%(nil s)%%xs H%%(Eq%%(list s) xs (cons%%s a (nil s))) ([H1:Eq%%(list s) xs (cons%%s a (nil s))]H1) ([H1:Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (nil s) (cons%%s c xs') /\ Eq%%(list s) xs (cons%%s c ys') /\ Adjoin%%s a xs' ys'))))]H1 (Eq%%(list s) xs (cons%%s a (nil s))) ([t:list s][H2:Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) (nil s) (cons%%s c t) /\ Eq%%(list s) xs (cons%%s c ys') /\ Adjoin%%s a t ys')))]H2 (Eq%%(list s) xs (cons%%s a (nil s))) ([t1:list s][H3:Ex%%s ([c:s](Eq%%(list s) (nil s) (cons%%s c t) /\ Eq%%(list s) xs (cons%%s c t1) /\ Adjoin%%s a t t1))]H3 (Eq%%(list s) xs (cons%%s a (nil s))) ([t2:s][H4:Eq%%(list s) (nil s) (cons%%s t2 t) /\ Eq%%(list s) xs (cons%%s t2 t1) /\ Adjoin%%s a t t1]H4%%(Eq%%(list s) xs (cons%%s a (nil s))) ([H5:Eq%%(list s) (nil s) (cons%%s t2 t) /\ Eq%%(list s) xs (cons%%s t2 t1)][H6:Adjoin%%s a t t1]nil_not_cons%%s t t2 (fst%%(Eq%%(list s) (nil s) (cons%%s t2 t))%%(Eq%%(list s) xs (cons%%s t2 t1)) H5) (Eq%%(list s) xs (cons%%s a (nil s))))))))];
[Adjoin_inv_corr4 : {s|SET}{a|s}{xs|list s}not (Adjoin%%s a xs (nil s))
  = [s|SET][a|s][xs|list s][H:Adjoin%%s a xs (nil s)]Adjoin_inv%%s%%a%%xs%%(nil s) H%%absurd ([H1:Eq%%(list s) (nil s) (cons%%s a xs)]nil_not_cons%%s xs a H1) ([H1:Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c xs') /\ Eq%%(list s) (nil s) (cons%%s c ys') /\ Adjoin%%s a xs' ys'))))]H1 absurd ([t:list s][H2:Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c t) /\ Eq%%(list s) (nil s) (cons%%s c ys') /\ Adjoin%%s a t ys')))]H2 absurd ([t1:list s][H3:Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c t) /\ Eq%%(list s) (nil s) (cons%%s c t1) /\ Adjoin%%s a t t1))]H3 absurd ([t2:s][H4:Eq%%(list s) xs (cons%%s t2 t) /\ Eq%%(list s) (nil s) (cons%%s t2 t1) /\ Adjoin%%s a t t1]H4%%absurd ([H5:Eq%%(list s) xs (cons%%s t2 t) /\ Eq%%(list s) (nil s) (cons%%s t2 t1)][H6:Adjoin%%s a t t1]H5%%absurd ([H7:Eq%%(list s) xs (cons%%s t2 t)][H8:Eq%%(list s) (nil s) (cons%%s t2 t1)]nil_not_cons%%s t1 t2 H8))))))];
[Adjoin_inv_corr5 : {s|SET}{a|s}{xs|list s}(Adjoin%%s a xs (cons%%s a (nil s)))->Eq%%(list s) xs (nil s)
  = [s|SET][a|s][xs|list s][H:Adjoin%%s a xs (cons%%s a (nil s))]Adjoin_inv%%s%%a%%xs%%(cons%%s a (nil s)) H%%(Eq%%(list s) xs (nil s)) ([H1:Eq%%(list s) (cons%%s a (nil s)) (cons%%s a xs)]cons_inj%%s%%a%%a%%(nil s)%%xs H1%%(Eq%%(list s) xs (nil s)) ([H2:Eq%%s a a][H3:Eq%%(list s) (nil s) xs]Eq_sym%%(list s)%%(nil s)%%xs H3)) ([H1:Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c xs') /\ Eq%%(list s) (cons%%s a (nil s)) (cons%%s c ys') /\ Adjoin%%s a xs' ys'))))]H1 (Eq%%(list s) xs (nil s)) ([t:list s][H2:Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c t) /\ Eq%%(list s) (cons%%s a (nil s)) (cons%%s c ys') /\ Adjoin%%s a t ys')))]H2 (Eq%%(list s) xs (nil s)) ([t1:list s][H3:Ex%%s ([c:s](Eq%%(list s) xs (cons%%s c t) /\ Eq%%(list s) (cons%%s a (nil s)) (cons%%s c t1) /\ Adjoin%%s a t t1))]H3 (Eq%%(list s) xs (nil s)) ([t2:s][H4:Eq%%(list s) xs (cons%%s t2 t) /\ Eq%%(list s) (cons%%s a (nil s)) (cons%%s t2 t1) /\ Adjoin%%s a t t1]H4%%(Eq%%(list s) xs (nil s)) ([H5:Eq%%(list s) xs (cons%%s t2 t) /\ Eq%%(list s) (cons%%s a (nil s)) (cons%%s t2 t1)][H6:Adjoin%%s a t t1]H5%%(Eq%%(list s) xs (nil s)) ([H7:Eq%%(list s) xs (cons%%s t2 t)][H8:Eq%%(list s) (cons%%s a (nil s)) (cons%%s t2 t1)]Adjoin_inv_corr4%%s%%a%%t (cons_inj%%s%%a%%t2%%(nil s)%%t1 H8%%(Adjoin%%s a t (nil s)) ([H9:Eq%%s a t2][H10:Eq%%(list s) (nil s) t1]Eq_subst%%(list s)%%t1%%(nil s) (Eq_sym%%(list s)%%(nil s)%%t1 H10) (Adjoin%%s a t) H6)) (Eq%%(list s) xs (nil s))))))))];
[Adjoin_com1 : {s|SET}{a,b|s}{xs,us,ys|list s}(Adjoin%%s a xs ys)->(Adjoin%%s b ys us)->Ex%%(list s) ([zs:list s](Adjoin%%s b xs zs /\ Adjoin%%s a zs us))
  = [s|SET][a,b|s][xs,us,ys|list s][sd1:Adjoin%%s a xs ys]Adjoin_elim%%s ([a'8:s][xs'9,ys'10:list s]{us'11:list s}(Adjoin%%s b ys'10 us'11)->Ex%%(list s) ([zs:list s](Adjoin%%s b xs'9 zs /\ Adjoin%%s a'8 zs us'11))) ([a1:s][xs1,us1:list s][sd2:Adjoin%%s b (cons%%s a1 xs1) us1]Adjoin_inv_corr1%%s%%b%%a1%%xs1%%us1 sd2%%(Ex%%(list s) ([zs:list s](Adjoin%%s b xs1 zs /\ Adjoin%%s a1 zs us1))) ([H:Eq%%(list s) us1 (cons%%s b (cons%%s a1 xs1))]ExIntro%%(list s) (cons%%s b xs1) ([zs:list s](Adjoin%%s b xs1 zs /\ Adjoin%%s a1 zs us1)) (pair%%(Adjoin%%s b xs1 (cons%%s b xs1))%%(Adjoin%%s a1 (cons%%s b xs1) us1) (ad1%%s b xs1) (Eq_subst%%(list s)%%(cons%%s b (cons%%s a1 xs1))%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s b (cons%%s a1 xs1)) H) (Adjoin%%s a1 (cons%%s b xs1)) (ad2%%s%%xs1%%a1%%(cons%%s a1 xs1) (ad1%%s a1 xs1) b)))) ([H:Ex%%(list s) ([ys':list s](Eq%%(list s) us1 (cons%%s a1 ys') /\ Adjoin%%s b xs1 ys'))]H (Ex%%(list s) ([zs:list s](Adjoin%%s b xs1 zs /\ Adjoin%%s a1 zs us1))) ([t:list s][H1:Eq%%(list s) us1 (cons%%s a1 t) /\ Adjoin%%s b xs1 t]H1%%(Ex%%(list s) ([zs:list s](Adjoin%%s b xs1 zs /\ Adjoin%%s a1 zs us1))) ([H2:Eq%%(list s) us1 (cons%%s a1 t)][H3:Adjoin%%s b xs1 t]ExIntro%%(list s) t ([zs:list s](Adjoin%%s b xs1 zs /\ Adjoin%%s a1 zs us1)) (pair%%(Adjoin%%s b xs1 t)%%(Adjoin%%s a1 t us1) H3 (Eq_subst%%(list s)%%(cons%%s a1 t)%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s a1 t) H2) (Adjoin%%s a1 t) (ad1%%s a1 t))))))) ([xs1|list s][a1|s][axs|list s][x1:Adjoin%%s a1 xs1 axs][b1:s][x1_ih:{us'13:list s}(Adjoin%%s b axs us'13)->Ex%%(list s) ([zs:list s](Adjoin%%s b xs1 zs /\ Adjoin%%s a1 zs us'13))][us1:list s][H:Adjoin%%s b (cons%%s b1 axs) us1]Adjoin_inv_corr1%%s%%b%%b1%%axs%%us1 H%%(Ex%%(list s) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1))) ([H1:Eq%%(list s) us1 (cons%%s b (cons%%s b1 axs))]ExIntro%%(list s) (cons%%s b (cons%%s b1 xs1)) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1)) (pair%%(Adjoin%%s b (cons%%s b1 xs1) (cons%%s b (cons%%s b1 xs1)))%%(Adjoin%%s a1 (cons%%s b (cons%%s b1 xs1)) us1) (ad1%%s b (cons%%s b1 xs1)) (Eq_subst%%(list s)%%(cons%%s b (cons%%s b1 axs))%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s b (cons%%s b1 axs)) H1) ([z:list s]Adjoin%%s a1 (cons%%s b (cons%%s b1 xs1)) z) (ad2%%s%%(cons%%s b1 xs1)%%a1%%(cons%%s b1 axs) (ad2%%s%%xs1%%a1%%axs x1 b1) b)))) ([H1:Ex%%(list s) ([ys':list s](Eq%%(list s) us1 (cons%%s b1 ys') /\ Adjoin%%s b axs ys'))]H1 (Ex%%(list s) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1))) ([t:list s][H2:Eq%%(list s) us1 (cons%%s b1 t) /\ Adjoin%%s b axs t]H2%%(Ex%%(list s) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1))) ([H3:Eq%%(list s) us1 (cons%%s b1 t)][H4:Adjoin%%s b axs t]x1_ih t H4 (Ex%%(list s) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1))) ([t1:list s][H5:Adjoin%%s b xs1 t1 /\ Adjoin%%s a1 t1 t]H5%%(Ex%%(list s) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1))) ([H6:Adjoin%%s b xs1 t1][H7:Adjoin%%s a1 t1 t]ExIntro%%(list s) (cons%%s b1 t1) ([zs:list s](Adjoin%%s b (cons%%s b1 xs1) zs /\ Adjoin%%s a1 zs us1)) (pair%%(Adjoin%%s b (cons%%s b1 xs1) (cons%%s b1 t1))%%(Adjoin%%s a1 (cons%%s b1 t1) us1) (ad2%%s%%xs1%%b%%t1 H6 b1) (Eq_subst%%(list s)%%(cons%%s b1 t)%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s b1 t) H3) (Adjoin%%s a1 (cons%%s b1 t1)) (ad2%%s%%t1%%a1%%t H7 b1)))))))))%%a%%xs%%ys sd1 us];
[Adjoin_com2 : {s|SET}{a,b|s}{xs,us,zs|list s}(Adjoin%%s b zs xs)->(Adjoin%%s a zs us)->Ex%%(list s) ([ys:list s](Adjoin%%s a xs ys /\ Adjoin%%s b us ys))
  = [s|SET][a,b|s][xs,us,zs|list s][sd1:Adjoin%%s b zs xs]Adjoin_elim%%s ([b'8:s][zs'9,xs'10:list s]{us'11:list s}(Adjoin%%s a zs'9 us'11)->Ex%%(list s) ([ys:list s](Adjoin%%s a xs'10 ys /\ Adjoin%%s b'8 us'11 ys))) ([b1:s][zs1,us1:list s][sd2:Adjoin%%s a zs1 us1]Adjoin_inv%%s%%a%%zs1%%us1 sd2%%(Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys))) ([H:Eq%%(list s) us1 (cons%%s a zs1)]ExIntro%%(list s) (cons%%s a (cons%%s b1 zs1)) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys)) (pair%%(Adjoin%%s a (cons%%s b1 zs1) (cons%%s a (cons%%s b1 zs1)))%%(Adjoin%%s b1 us1 (cons%%s a (cons%%s b1 zs1))) (ad1%%s a (cons%%s b1 zs1)) (Eq_subst%%(list s)%%(cons%%s a zs1)%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s a zs1) H) ([us1'13:list s]Adjoin%%s b1 us1'13 (cons%%s a (cons%%s b1 zs1))) (ad2%%s%%zs1%%b1%%(cons%%s b1 zs1) (ad1%%s b1 zs1) a)))) ([H:Ex%%(list s) ([xs':list s]Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) zs1 (cons%%s c xs') /\ Eq%%(list s) us1 (cons%%s c ys') /\ Adjoin%%s a xs' ys'))))]H (Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys))) ([zs':list s][H1:Ex%%(list s) ([ys':list s]Ex%%s ([c:s](Eq%%(list s) zs1 (cons%%s c zs') /\ Eq%%(list s) us1 (cons%%s c ys') /\ Adjoin%%s a zs' ys')))]H1 (Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys))) ([us':list s][H2:Ex%%s ([c:s](Eq%%(list s) zs1 (cons%%s c zs') /\ Eq%%(list s) us1 (cons%%s c us') /\ Adjoin%%s a zs' us'))]H2 (Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys))) ([c:s][H3:Eq%%(list s) zs1 (cons%%s c zs') /\ Eq%%(list s) us1 (cons%%s c us') /\ Adjoin%%s a zs' us']H3%%(Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys))) ([H4:Eq%%(list s) zs1 (cons%%s c zs') /\ Eq%%(list s) us1 (cons%%s c us')][H5:Adjoin%%s a zs' us']H4%%(Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys))) ([H6:Eq%%(list s) zs1 (cons%%s c zs')][H7:Eq%%(list s) us1 (cons%%s c us')]ExIntro%%(list s) (cons%%s b1 (cons%%s c us')) ([ys:list s](Adjoin%%s a (cons%%s b1 zs1) ys /\ Adjoin%%s b1 us1 ys)) (pair%%(Adjoin%%s a (cons%%s b1 zs1) (cons%%s b1 (cons%%s c us')))%%(Adjoin%%s b1 us1 (cons%%s b1 (cons%%s c us'))) (ad2%%s%%zs1%%a%%(cons%%s c us') (Eq_subst%%(list s)%%(cons%%s c zs')%%zs1 (Eq_sym%%(list s)%%zs1%%(cons%%s c zs') H6) ([zs1'23:list s]Adjoin%%s a zs1'23 (cons%%s c us')) (ad2%%s%%zs'%%a%%us' H5 c)) b1) (Eq_subst%%(list s)%%(cons%%s c us')%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s c us') H7) ([us1'23:list s]Adjoin%%s b1 us1'23 (cons%%s b1 (cons%%s c us'))) (ad1%%s b1 (cons%%s c us'))))))))))) ([zs1|list s][b1|s][xs1|list s][sd3:Adjoin%%s b1 zs1 xs1][c:s][IH:{us'13:list s}(Adjoin%%s a zs1 us'13)->Ex%%(list s) ([ys:list s](Adjoin%%s a xs1 ys /\ Adjoin%%s b1 us'13 ys))][us':list s][sd4:Adjoin%%s a (cons%%s c zs1) us']Adjoin_inv_corr1%%s%%a%%c%%zs1%%us' sd4%%(Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys))) ([H:Eq%%(list s) us' (cons%%s a (cons%%s c zs1))]ExIntro%%(list s) (cons%%s a (cons%%s c xs1)) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys)) (pair%%(Adjoin%%s a (cons%%s c xs1) (cons%%s a (cons%%s c xs1)))%%(Adjoin%%s b1 us' (cons%%s a (cons%%s c xs1))) (ad1%%s a (cons%%s c xs1)) (Eq_subst%%(list s)%%(cons%%s a (cons%%s c zs1))%%us' (Eq_sym%%(list s)%%us'%%(cons%%s a (cons%%s c zs1)) H) ([us''17:list s]Adjoin%%s b1 us''17 (cons%%s a (cons%%s c xs1))) (ad2%%s%%(cons%%s c zs1)%%b1%%(cons%%s c xs1) (ad2%%s%%zs1%%b1%%xs1 sd3 c) a)))) ([H:Ex%%(list s) ([ys':list s](Eq%%(list s) us' (cons%%s c ys') /\ Adjoin%%s a zs1 ys'))]H (Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys))) ([us'':list s][H1:Eq%%(list s) us' (cons%%s c us'') /\ Adjoin%%s a zs1 us'']H1%%(Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys))) ([H2:Eq%%(list s) us' (cons%%s c us'')][H3:Adjoin%%s a zs1 us'']IH us'' H3 (Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys))) ([us1:list s][H4:Adjoin%%s a xs1 us1 /\ Adjoin%%s b1 us'' us1]H4%%(Ex%%(list s) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys))) ([H5:Adjoin%%s a xs1 us1][H6:Adjoin%%s b1 us'' us1]ExIntro%%(list s) (cons%%s c us1) ([ys:list s](Adjoin%%s a (cons%%s c xs1) ys /\ Adjoin%%s b1 us' ys)) (pair%%(Adjoin%%s a (cons%%s c xs1) (cons%%s c us1))%%(Adjoin%%s b1 us' (cons%%s c us1)) (ad2%%s%%xs1%%a%%us1 H5 c) (Eq_subst%%(list s)%%(cons%%s c us'')%%us' (Eq_sym%%(list s)%%us'%%(cons%%s c us'') H2) ([us''25:list s]Adjoin%%s b1 us''25 (cons%%s c us1)) (ad2%%s%%us''%%b1%%us1 H6 c)))))))))%%b%%zs%%xs sd1 us];
[Adjoin_com3 : {s|SET}{a,b|s}{xs,us,ys|list s}(Adjoin%%s a xs ys)->(Adjoin%%s b us ys)->((Eq%%(list s) us xs /\ Eq%%s b a) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs /\ Adjoin%%s a zs us)))
  = [s|SET][a,b|s][xs,us,ys|list s][H:Adjoin%%s a xs ys][H1:Adjoin%%s b us ys]Adjoin_elim%%s ([a'9:s][xs'10,ys'11:list s]{us'12:list s}(Adjoin%%s b us'12 ys'11)->((Eq%%(list s) us'12 xs'10 /\ Eq%%s b a'9) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs'10 /\ Adjoin%%s a'9 zs us'12)))) ([a1:s][xs1,us1:list s][H2:Adjoin%%s b us1 (cons%%s a1 xs1)]Adjoin_inv_corr2%%s%%b%%a1%%us1%%xs1 H2%%((Eq%%(list s) us1 xs1 /\ Eq%%s b a1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1))) ([H3:Eq%%s b a1 /\ Eq%%(list s) us1 xs1]H3%%((Eq%%(list s) us1 xs1 /\ Eq%%s b a1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1))) ([H4:Eq%%s b a1][H5:Eq%%(list s) us1 xs1]inl%%(Eq%%(list s) us1 xs1 /\ Eq%%s b a1)%%(Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1))) (pair%%(Eq%%(list s) us1 xs1)%%(Eq%%s b a1) H5 H4))) ([H3:Ex%%(list s) ([xs':list s](Eq%%(list s) us1 (cons%%s a1 xs') /\ Adjoin%%s b xs' xs1))]H3 ((Eq%%(list s) us1 xs1 /\ Eq%%s b a1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1))) ([us':list s][H4:Eq%%(list s) us1 (cons%%s a1 us') /\ Adjoin%%s b us' xs1]H4%%((Eq%%(list s) us1 xs1 /\ Eq%%s b a1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1))) ([H5:Eq%%(list s) us1 (cons%%s a1 us')][H6:Adjoin%%s b us' xs1]inr%%(Eq%%(list s) us1 xs1 /\ Eq%%s b a1)%%(Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1))) (ExIntro%%(list s) us' ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s a1 zs us1)) (pair%%(Adjoin%%s b us' xs1)%%(Adjoin%%s a1 us' us1) H6 (Eq_subst%%(list s)%%(cons%%s a1 us')%%us1 (Eq_sym%%(list s)%%us1%%(cons%%s a1 us') H5) (Adjoin%%s a1 us') (ad1%%s a1 us')))))))) ([xs1|list s][b1|s][zs1|list s][s1:Adjoin%%s b1 xs1 zs1][c:s][IH:{us'14:list s}(Adjoin%%s b us'14 zs1)->((Eq%%(list s) us'14 xs1 /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s b1 zs us'14)))][us':list s][s2:Adjoin%%s b us' (cons%%s c zs1)]Adjoin_inv_corr2%%s%%b%%c%%us'%%zs1 s2%%((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([H2:Eq%%s b c /\ Eq%%(list s) us' zs1]H2%%((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([H3:Eq%%s b c][H4:Eq%%(list s) us' zs1]inr%%(Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1)%%(Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) (ExIntro%%(list s) xs1 ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us')) (pair%%(Adjoin%%s b xs1 (cons%%s c xs1))%%(Adjoin%%s b1 xs1 us') (Eq_subst%%s%%c%%b (Eq_sym%%s%%b%%c H3) ([b'20:s]Adjoin%%s b'20 xs1 (cons%%s c xs1)) (ad1%%s c xs1)) (Eq_subst%%(list s)%%zs1%%us' (Eq_sym%%(list s)%%us'%%zs1 H4) (Adjoin%%s b1 xs1) s1))))) ([H2:Ex%%(list s) ([xs':list s](Eq%%(list s) us' (cons%%s c xs') /\ Adjoin%%s b xs' zs1))]H2 ((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([us'':list s][H3:Eq%%(list s) us' (cons%%s c us'') /\ Adjoin%%s b us'' zs1]H3%%((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([H4:Eq%%(list s) us' (cons%%s c us'')][H5:Adjoin%%s b us'' zs1]IH us'' H5%%((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([H6:Eq%%(list s) us'' xs1 /\ Eq%%s b b1]inl%%(Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1)%%(Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) (H6%%(Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) ([H7:Eq%%(list s) us'' xs1][H8:Eq%%s b b1]pair%%(Eq%%(list s) us' (cons%%s c xs1))%%(Eq%%s b b1) (Eq_subst%%(list s)%%(cons%%s c us'')%%us' (Eq_sym%%(list s)%%us'%%(cons%%s c us'') H4) ([us''25:list s]Eq%%(list s) us''25 (cons%%s c xs1)) (Eq_resp%%(list s)%%(list s) (cons%%s c)%%us''%%xs1 H7)) H8))) ([H6:Ex%%(list s) ([zs:list s](Adjoin%%s b zs xs1 /\ Adjoin%%s b1 zs us''))]H6 ((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([ys1:list s][H7:Adjoin%%s b ys1 xs1 /\ Adjoin%%s b1 ys1 us'']H7%%((Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1) \/ Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) ([H8:Adjoin%%s b ys1 xs1][H9:Adjoin%%s b1 ys1 us'']inr%%(Eq%%(list s) us' (cons%%s c xs1) /\ Eq%%s b b1)%%(Ex%%(list s) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us'))) (ExIntro%%(list s) (cons%%s c ys1) ([zs:list s](Adjoin%%s b zs (cons%%s c xs1) /\ Adjoin%%s b1 zs us')) (pair%%(Adjoin%%s b (cons%%s c ys1) (cons%%s c xs1))%%(Adjoin%%s b1 (cons%%s c ys1) us') (ad2%%s%%ys1%%b%%xs1 H8 c) (Eq_subst%%(list s)%%(cons%%s c us'')%%us' (Eq_sym%%(list s)%%us'%%(cons%%s c us'') H4) (Adjoin%%s b1 (cons%%s c ys1)) (ad2%%s%%ys1%%b1%%us'' H9 c)))))))))))%%a%%xs%%ys H us H1];
[Adjoin_length_suc : {s|SET}{a|s}{l,al|list s}(Adjoin%%s a l al)->Eq%%nat (length%%s al) (suc (length%%s l))
  = [s|SET]Adjoin_elim%%s ([a:s][l,al:list s]Eq%%nat (length%%s al) (suc (length%%s l))) ([a:s][xs:list s]Eq_refl%%nat (length%%s (cons%%s a xs))) ([xs|list s][a|s][axs|list s][x1:Adjoin%%s a xs axs][b:s][x1_ih:Eq%%nat (length%%s axs) (suc (length%%s xs))]Eq_resp%%nat%%nat suc%%(list_elim%%s ([_:list s]nat) zero ([y:s][_:list s]([_:s]suc) y) axs)%%(length%%s (cons%%s b xs)) x1_ih)];
