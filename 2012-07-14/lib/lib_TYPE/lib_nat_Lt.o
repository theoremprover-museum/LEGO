Module lib_nat_Lt Import "lib_nat_minus_thms";
[Lt : nat->nat->Prop
  = [n,m:nat]Ex%%nat ([k:nat]Eq%%nat (plus n (suc k)) m)];
[zero_Lt_suc_n : {n:nat}Lt zero (suc n)
  = [n:nat]ExIntro%%nat n ([k:nat]Eq%%nat (plus zero (suc k)) (suc n)) (Eq_refl%%nat (plus zero (suc n)))];
[n_Lt_suc_n : {n:nat}Lt n (suc n)
  = [n:nat]ExIntro%%nat zero ([k:nat]Eq%%nat (plus n (suc k)) (suc n)) (Eq_subst%%nat%%(plus (suc zero) n)%%(plus n (suc zero)) (plus_commutes (suc zero) n) ([t:nat]Eq%%nat t (suc n)) (Eq_refl%%nat (plus (suc zero) n)))];
[Lt_trans : {l,m,n|nat}(Lt l m)->(Lt m n)->Lt l n
  = [l,m,n|nat][Ltlm:Lt l m][Ltmn:Lt m n]Ltlm (Lt l n) ([o:nat][EqlSucom:Eq%%nat (plus l (suc o)) m]Ltmn (Lt l n) ([p:nat][EqmSucpn:Eq%%nat (plus m (suc p)) n]ExIntro%%nat (suc (plus o p)) ([k:nat]Eq%%nat (plus l (suc k)) n) (Eq_subst%%nat%%(plus (plus l (suc (suc o))) p)%%(plus l (plus (suc (suc o)) p)) (plus_assoc l (suc (suc o)) p) ([t:nat]Eq%%nat t n) (Eq_subst%%nat%%(suc (plus l (suc o)))%%(plus l (suc (suc o))) (Eq_sym%%nat%%(plus l (suc (suc o)))%%(suc (plus l (suc o))) (plus_suc l (suc o))) ([t:nat]Eq%%nat (plus t p) n) (Eq_subst%%nat%%m%%(plus l (suc o)) (Eq_sym%%nat%%(plus l (suc o))%%m EqlSucom) ([t:nat]Eq%%nat (plus (suc t) p) n) (Eq_subst%%nat%%(plus m (suc p))%%(suc (plus m p)) (plus_suc m p) ([t:nat]Eq%%nat t n) EqmSucpn))))))];
[not_n_Lt_zero : {n:nat}not (Lt n zero)
  = [n:nat][LtnZero:Lt n zero]LtnZero absurd ([t:nat][h:Eq%%nat (plus n (suc t)) zero]zero_not_suc (plus n t) (Eq_subst%%nat%%(plus n (suc t))%%(suc (plus n t)) (plus_suc n t) ([u:nat]Eq%%nat zero u) (Eq_sym%%nat%%(plus n (suc t))%%zero h)))];
[not_refl_Lt : {x:nat}not (Lt x x)
  = [x:nat][H:Lt x x]H absurd ([t:nat][H1:Eq%%nat (plus x (suc t)) x]plus_suc_lemma x t H1)];
[Lt_not_Eq : {x,y:nat}(Lt x y)->not (Eq%%nat x y)
  = [x,y:nat][H:Lt x y]H (not (Eq%%nat x y)) ([t:nat][H1:Eq%%nat (plus x (suc t)) y]Eq_subst%%nat%%(plus x (suc t))%%y (Eq_sym%%nat%%y%%(plus x (suc t)) (Eq_sym%%nat%%(plus x (suc t))%%y H1)) ([z:nat]not (Eq%%nat x z)) ([H2:Eq%%nat x (plus x (suc t))]plus_suc_lemma x t (Eq_sym%%nat%%x%%(plus x (suc t)) H2)))];
[Lt_zero : {n:nat}(not (Eq%%nat n zero))->Lt zero n
  = nat_elim ([n:nat](not (Eq%%nat n zero))->Lt zero n) ([H:not (Eq%%nat zero zero)]H (Eq_refl%%nat zero) (Lt zero zero)) ([x1:nat][x1_ih:(not (Eq%%nat x1 zero))->Lt zero x1][H:not (Eq%%nat (suc x1) zero)]zero_Lt_suc_n x1)];
[Lt_resp_suc : {m,n:nat}(Lt m n)->Lt (suc m) (suc n)
  = [m,n:nat][Ltmn:Lt m n]Ltmn (Lt (suc m) (suc n)) ([t:nat][h:Eq%%nat (plus m (suc t)) n]ExIntro%%nat t ([k:nat]Eq%%nat (plus (suc m) (suc k)) (suc n)) (Eq_resp_suc%%(plus m (suc t))%%n h))];
[Lt_resp_pred : {x,y:nat}(Lt (suc x) (suc y))->Lt x y
  = [x,y:nat][H:Lt (suc x) (suc y)]H (Lt x y) ([t:nat][H1:Eq%%nat (plus (suc x) (suc t)) (suc y)]ExIntro%%nat t ([k:nat]Eq%%nat (plus x (suc k)) y) (suc_injective%%(plus x (suc t))%%y (Eq_subst%%nat%%(suc y)%%(plus (suc x) (suc t)) (Eq_sym%%nat%%(plus (suc x) (suc t))%%(suc y) H1) ([z:nat]Eq%%nat z (suc y)) (Eq_refl%%nat (suc y)))))];
[Lt_pred : {a,b|nat}(Lt a b)->Lt (pred b) b
  = ([Phi:{z:nat}{a|nat}(Lt a z)->Lt (pred z) z][a,b|nat]Phi b%%a) (nat_elim ([z:nat]{a|nat}(Lt a z)->Lt (pred z) z) ([a|nat][H:Lt a zero]not_n_Lt_zero a H (Lt (pred zero) zero)) ([x1:nat][x1_ih:{a|nat}(Lt a x1)->Lt (pred x1) x1][a|nat][H:Lt a (suc x1)]n_Lt_suc_n (pred (suc x1))))];
[Lt_suc_pred : {a,b|nat}(Lt (suc a) b)->Lt a (pred b)
  = ([Phi:{z:nat}{a|nat}(Lt (suc a) z)->Lt a (pred z)][a,b|nat]Phi b%%a) (nat_elim ([z:nat]{a|nat}(Lt (suc a) z)->Lt a (pred z)) ([a|nat][H:Lt (suc a) zero]not_n_Lt_zero (suc a) H (Lt a (pred zero))) ([x1:nat][x1_ih:{a|nat}(Lt (suc a) x1)->Lt a (pred x1)][a|nat][H:Lt (suc a) (suc x1)]Lt_resp_pred a (pred (suc x1)) H))];
[Lt_not_zero : {a,b|nat}(Lt a b)->not (Eq%%nat b zero)
  = ([Phi:{z:nat}{a|nat}(Lt a z)->(Eq%%nat z zero)->absurd][a,b|nat]Phi b%%a) (nat_elim ([z:nat]{a|nat}(Lt a z)->(Eq%%nat z zero)->absurd) ([a|nat][H:Lt a zero][H1:Eq%%nat zero zero](!nat zero injective!) H1%%absurd (not_n_Lt_zero a H)) ([x1:nat][x1_ih:{a|nat}(Lt a x1)->(Eq%%nat x1 zero)->absurd][a|nat][H:Lt a (suc x1)][H1:Eq%%nat (suc x1) zero]Eq_subst%%nat%%(suc x1)%%zero H1 (!nat is suc!) ([Phaha:Prop][haha:Phaha]haha)))];
[Lt_pred_suc : {a,b|nat}(Lt a (pred b))->Eq%%nat b (suc (pred b))
  = ([Phi:{z:nat}{a|nat}(Lt a (pred z))->Eq%%nat z (suc (pred z))][a,b|nat]Phi b%%a) (nat_elim ([z:nat]{a|nat}(Lt a (pred z))->Eq%%nat z (suc (pred z))) ([a|nat][H:Lt a (pred zero)]not_n_Lt_zero a H (Eq%%nat zero (suc (pred zero)))) ([x1:nat][x1_ih:{a|nat}(Lt a (pred x1))->Eq%%nat x1 (suc (pred x1))][a|nat][H:Lt a (pred (suc x1))]Eq_refl%%nat (suc x1)))];
[Lt_pred_suc' : {a,b|nat}(Lt (pred a) b)->Lt a (suc b)
  = nat_elim ([a:nat]{b|nat}(Lt (pred a) b)->Lt a (suc b)) ([b|nat][H:Lt (pred zero) b]zero_Lt_suc_n b) ([x1:nat][x1_ih:{b|nat}(Lt (pred x1) b)->Lt x1 (suc b)][b|nat][H:Lt (pred (suc x1)) b]Lt_resp_suc x1 b H)];
[Lt_pred_suc'' : {a,b|nat}(Lt a (pred b))->Lt (suc a) b
  = [a,b|nat][H:Lt a (pred b)]Eq_subst%%nat%%(suc (pred b))%%b (Eq_sym%%nat%%b%%(suc (pred b)) (Lt_pred_suc%%a%%b H)) ([z:nat]Lt (suc a) z) (Lt_resp_suc a (pred b) H)];
[n_Lt_suc_m_character : {n,m|nat}(Lt n (suc m))->(Lt n m \/ Eq%%nat n m)
  = [n,m|nat][H:Lt n (suc m)]H (Lt n m \/ Eq%%nat n m) (nat_ind ([t:nat](Eq%%nat (plus n (suc t)) (suc m))->(Lt n m \/ Eq%%nat n m)) ([H1:Eq%%nat (plus n (suc zero)) (suc m)]inr%%(Lt n m)%%(Eq%%nat n m) (suc_injective%%n%%m (Eq_subst%%nat%%(plus n (suc zero))%%(suc m) (Eq_sym%%nat%%(suc m)%%(plus n (suc zero)) (Eq_sym%%nat%%(plus n (suc zero))%%(suc m) H1)) ([z:nat]Eq%%nat (suc n) z) (Eq_subst%%nat%%(suc (plus n zero))%%(plus n (suc zero)) (Eq_sym%%nat%%(plus n (suc zero))%%(suc (plus n zero)) (plus_suc n zero)) ([z:nat]Eq%%nat (suc n) z) (Eq_subst%%nat%%n%%(plus n zero) (Eq_sym%%nat%%(plus n zero)%%n (plus_zero n)) ([z:nat]Eq%%nat (suc n) (suc z)) (Eq_refl%%nat (suc n))))))) ([n1:nat][H1:(Eq%%nat (plus n (suc n1)) (suc m))->(Lt n m \/ Eq%%nat n m)][H2:Eq%%nat (plus n (suc (suc n1))) (suc m)]inl%%(Lt n m)%%(Eq%%nat n m) (ExIntro%%nat n1 ([k:nat]Eq%%nat (plus n (suc k)) m) (suc_injective%%(plus n (suc n1))%%m (Eq_subst%%nat%%(plus n (suc (suc n1)))%%(suc m) (Eq_sym%%nat%%(suc m)%%(plus n (suc (suc n1))) (Eq_sym%%nat%%(plus n (suc (suc n1)))%%(suc m) H2)) ([z:nat]Eq%%nat (suc (plus n (suc n1))) z) (Eq_sym%%nat%%(plus n (suc (suc n1)))%%(suc (plus n (suc n1))) (plus_suc n (suc n1))))))))];
[plus_resp_Lt_l : {l,m|nat}(Lt l m)->{n:nat}Lt (plus l n) (plus m n)
  = [l,m|nat][Ltlm:Lt l m]nat_ind ([n:nat]Lt (plus l n) (plus m n)) (Eq_subst%%nat%%l%%(plus l zero) (Eq_sym%%nat%%(plus l zero)%%l (plus_zero l)) ([z:nat]Lt z (plus m zero)) (Eq_subst%%nat%%m%%(plus m zero) (Eq_sym%%nat%%(plus m zero)%%m (plus_zero m)) ([z:nat]Lt l z) Ltlm)) ([x:nat][Ltlxmx:Lt (plus l x) (plus m x)]Eq_subst%%nat%%(suc (plus l x))%%(plus l (suc x)) (Eq_sym%%nat%%(plus l (suc x))%%(suc (plus l x)) (plus_suc l x)) ([z:nat]Lt z (plus m (suc x))) (Eq_subst%%nat%%(suc (plus m x))%%(plus m (suc x)) (Eq_sym%%nat%%(plus m (suc x))%%(suc (plus m x)) (plus_suc m x)) ([z:nat]Lt (suc (plus l x)) z) (Lt_resp_suc (plus l x) (plus m x) Ltlxmx)))];
[Lt_resp_plus : {x,y,z:nat}(Lt x y)->Lt (plus z x) (plus z y)
  = [x,y,z:nat]nat_ind ([z'4:nat](Lt x y)->Lt (plus z'4 x) (plus z'4 y)) ([H:Lt x y]H) ([n:nat][H:(Lt x y)->Lt (plus n x) (plus n y)][H1:Lt x y]Lt_resp_suc (nat_elim ([_:nat]nat) x ([_:nat]suc) n) (nat_elim ([_:nat]nat) y ([_:nat]suc) n) (H H1)) z];
[Lt_resp_plus_both : {x,y,a,b:nat}(Lt x y)->(Lt a b)->Lt (plus x a) (plus y b)
  = [x,y,a,b:nat][h1:Lt x y][h2:Lt a b]Lt_trans%%(plus x a)%%(plus x b)%%(plus y b) (Lt_resp_plus a b x h2) (Eq_subst%%nat%%(plus b x)%%(plus x b) (Eq_sym%%nat%%(plus x b)%%(plus b x) (plus_commutes x b)) ([z:nat]Lt z (plus y b)) (Eq_subst%%nat%%(plus b y)%%(plus y b) (Eq_sym%%nat%%(plus y b)%%(plus b y) (plus_commutes y b)) ([z:nat]Lt (plus b x) z) (Lt_resp_plus x y b h1)))];
[Lt_resp_plus_right : {a,x,y|nat}(Lt x y)->Lt x (plus a y)
  = nat_elim ([a:nat]{x,y|nat}(Lt x y)->Lt x (plus a y)) ([x,y|nat][H:Lt x y]H) ([x1:nat][x1_ih:{x,y|nat}(Lt x y)->Lt x (plus x1 y)][x,y|nat][H:Lt x y]Lt_trans%%x%%(plus x1 y)%%(plus (suc x1) y) (x1_ih%%x%%y H) (n_Lt_suc_n (plus x1 y)))];
[Lt_resp_times : {x,y,a:nat}(Lt x y)->Lt (times (suc a) x) (times (suc a) y)
  = [x,y,a:nat]nat_ind ([a'4:nat](Lt x y)->Lt (times (suc a'4) x) (times (suc a'4) y)) ([H:Lt x y]H (Lt (times (suc zero) x) (times (suc zero) y)) ([t:nat][H1:Eq%%nat (plus x (suc t)) y]ExIntro%%nat t ([k:nat]Eq%%nat (plus (times (suc zero) x) (suc k)) (times (suc zero) y)) (Eq_subst%%nat%%y%%(plus y zero) (Eq_sym%%nat%%(plus y zero)%%y (plus_zero y)) ([z:nat]Eq%%nat (plus (times (suc zero) x) (suc t)) z) (Eq_subst%%nat%%x%%(plus x zero) (Eq_sym%%nat%%(plus x zero)%%x (plus_zero x)) ([z:nat]Eq%%nat (plus z (suc t)) y) H1)))) ([n:nat][H:(Lt x y)->Lt (times (suc n) x) (times (suc n) y)][H1:Lt x y]Lt_resp_plus_both x y (nat_elim ([_:nat]nat) zero ([_:nat]plus x) (suc n)) (nat_elim ([_:nat]nat) zero ([_:nat]plus y) (suc n)) H1 (H H1)) a];
[Lt_resp_sub : {x,y,z:nat}(Lt (plus z x) (plus z y))->Lt x y
  = [x,y,z:nat]nat_ind ([z'4:nat](Lt (plus z'4 x) (plus z'4 y))->Lt x y) ([H:Lt (plus zero x) (plus zero y)]H) ([n:nat][H:(Lt (plus n x) (plus n y))->Lt x y][H1:Lt (plus (suc n) x) (plus (suc n) y)]H (Lt_resp_pred (plus n x) (plus n y) H1)) z];
[Lt_times_cancel : {x,y,a:nat}(Lt (times x (suc a)) (times y (suc a)))->Lt x y
  = [x,y,a:nat]nat_diagonal_ind ([x'4,y'5:nat](Lt (times x'4 (suc a)) (times y'5 (suc a)))->Lt x'4 y'5) ([m:nat]nat_ind ([m'5:nat](Lt (times zero (suc a)) (times m'5 (suc a)))->Lt zero m'5) ([H:Lt (times zero (suc a)) (times zero (suc a))]not_n_Lt_zero (times zero (suc a)) H (Lt zero zero)) ([n:nat][H:(Lt (times zero (suc a)) (times n (suc a)))->Lt zero n][H1:Lt (times zero (suc a)) (times (suc n) (suc a))]zero_Lt_suc_n n) m) ([n:nat][H:Lt (times (suc n) (suc a)) (times zero (suc a))]not_n_Lt_zero (times (suc n) (suc a)) H (Lt (suc n) zero)) ([n,m:nat][H:(Lt (times n (suc a)) (times m (suc a)))->Lt n m][H1:Lt (times (suc n) (suc a)) (times (suc m) (suc a))]Lt_resp_suc n m (H (Lt_resp_sub (times n (suc a)) (times m (suc a)) (suc a) H1))) x y];
[ze_Lt_imp_Eq_suc : {m:nat}(Lt zero m)->Ex%%nat ([n:nat]Eq%%nat m (suc n))
  = [m:nat]nat_ind ([m'2:nat](Lt zero m'2)->Ex%%nat ([n:nat]Eq%%nat m'2 (suc n))) ([H:Lt zero zero]not_n_Lt_zero zero H (Ex%%nat ([n:nat]Eq%%nat zero (suc n)))) ([n:nat][H:(Lt zero n)->Ex%%nat ([n'4:nat]Eq%%nat n (suc n'4))][H1:Lt zero (suc n)]ExIntro%%nat n ([n'5:nat]Eq%%nat (suc n) (suc n'5)) (Eq_refl%%nat (suc n))) m];
[exists_suc : {P:nat->Prop}{n:nat}iff (Ex%%nat ([t:nat](Lt t (suc n) /\ P t))) (Ex%%nat ([t:nat](Lt t n /\ P t)) \/ P n)
  = [P:nat->Prop][n:nat]pair%%((Ex%%nat ([t:nat](Lt t (suc n) /\ P t)))->(Ex%%nat ([t:nat](Lt t n /\ P t)) \/ P n))%%((Ex%%nat ([t:nat](Lt t n /\ P t)) \/ P n)->Ex%%nat ([t:nat](Lt t (suc n) /\ P t))) ([H:Ex%%nat ([t:nat](Lt t (suc n) /\ P t))]H (Ex%%nat ([t:nat](Lt t n /\ P t)) \/ P n) ([t:nat][H1:Lt t (suc n) /\ P t]n_Lt_suc_m_character%%t%%n (fst%%(Lt t (suc n))%%(P t) H1)%%(Ex%%nat ([t'6:nat](Lt t'6 n /\ P t'6)) \/ P n) ([H2:Lt t n]inl%%(Ex%%nat ([t'7:nat](Lt t'7 n /\ P t'7)))%%(P n) (ExIntro%%nat t ([t'7:nat](Lt t'7 n /\ P t'7)) (pair%%(Lt t n)%%(P t) H2 (snd%%(Lt t (suc n))%%(P t) H1)))) ([H2:Eq%%nat t n]inr%%(Ex%%nat ([t'7:nat](Lt t'7 n /\ P t'7)))%%(P n) (Eq_subst%%nat%%t%%n (Eq_sym%%nat%%n%%t (Eq_sym%%nat%%t%%n H2)) ([z:nat]P z) (snd%%(Lt t (suc n))%%(P t) H1))))) ([H:Ex%%nat ([t:nat](Lt t n /\ P t)) \/ P n]H%%(Ex%%nat ([t:nat](Lt t (suc n) /\ P t))) ([H1:Ex%%nat ([t:nat](Lt t n /\ P t))]H1 (Ex%%nat ([t:nat](Lt t (suc n) /\ P t))) ([t:nat][H2:Lt t n /\ P t]ExIntro%%nat t ([t'7:nat](Lt t'7 (suc n) /\ P t'7)) (pair%%(Lt t (suc n))%%(P t) (Lt_trans%%t%%n%%(suc n) (fst%%(Lt t n)%%(P t) H2) (n_Lt_suc_n n)) (snd%%(Lt t n)%%(P t) H2)))) ([H1:P n]ExIntro%%nat n ([t:nat](Lt t (suc n) /\ P t)) (pair%%(Lt n (suc n))%%(P n) (n_Lt_suc_n n) H1)))];
[complete_induction : {P:nat->Prop}{wf_ih:{n:nat}({x:nat}(Lt x n)->P x)->P n}{m:nat}P m
  = [P:nat->Prop][wf_ih:{n:nat}({x:nat}(Lt x n)->P x)->P n][m:nat]wf_ih m (nat_ind ([m'4:nat]{x:nat}(Lt x m'4)->P x) ([x:nat][H:Lt x zero]not_n_Lt_zero x H (P x)) ([n:nat][H:{x:nat}(Lt x n)->P x][x:nat][H1:Lt x (suc n)]n_Lt_suc_m_character%%x%%n H1%%(P x) ([H2:Lt x n]H x H2) ([H2:Eq%%nat x n]wf_ih x (Eq_subst%%nat%%n%%x (Eq_sym%%nat%%x%%n H2) ([z:nat]{x'2:nat}(Lt x'2 z)->P x'2) H))) m)];
[well_founded_induction : {t|TYPE}{f:t->nat}{P:t->Prop}{ih:{x:t}({y:t}(Lt (f y) (f x))->P y)->P x}{z:t}P z
  = [t|TYPE][f:t->nat][P:t->Prop][ih:{x:t}({y:t}(Lt (f y) (f x))->P y)->P x][z:t]complete_induction ([n:nat]{y:t}(Eq%%nat n (f y))->P y) ([n:nat][H:{x:nat}(Lt x n)->{y:t}(Eq%%nat x (f y))->P y][y:t][H1:Eq%%nat n (f y)]ih y ([y1:t][H2:Lt (f y1) (f y)]H (f y1) (Eq_subst%%nat%%(f y)%%n (Eq_sym%%nat%%n%%(f y) H1) ([z'1:nat]Lt (f y1) z'1) H2) y1 (Eq_refl%%nat (f y1)))) (f z) z (Eq_refl%%nat (f z))];
[nested_complete_induction : {P:nat->nat->Prop}{wf_ih:{n,m:nat}{ih:{x,y:nat}(Lt x n \/ (Eq%%nat x n /\ Lt y m))->P x y}P n m}{n,m:nat}P n m
  = [P:nat->nat->Prop][wf_ih:{n,m:nat}{ih:{x,y:nat}(Lt x n \/ (Eq%%nat x n /\ Lt y m))->P x y}P n m][n,m:nat]complete_induction ([n'5:nat]{m'6:nat}P n'5 m'6) ([n1:nat][H:{x:nat}(Lt x n1)->{m'8:nat}P x m'8][m1:nat]complete_induction ([m1'8:nat]P n1 m1'8) ([n2:nat][H1:{x:nat}(Lt x n2)->P n1 x]wf_ih n1 n2 ([x,y:nat][H2:Lt x n1 \/ (Eq%%nat x n1 /\ Lt y n2)]H2%%(P x y) ([H3:Lt x n1]H x H3 y) ([H3:Eq%%nat x n1 /\ Lt y n2]Eq_subst%%nat%%n1%%x (Eq_sym%%nat%%x%%n1 (fst%%(Eq%%nat x n1)%%(Lt y n2) H3)) ([z:nat]P z y) (H1 y (snd%%(Eq%%nat x n1)%%(Lt y n2) H3))))) m1) n m];
