Module lib_int_mod Import "lib_int_basics_thms";
[Mod : {m,x,r:int.1}Prop
  = [m,x,r:int.1]Ex%%int.1 ([k:int.1]eq%%int (plus_zed r (times_zed k m)) x)];
[plus_resp_mod : {m,x1,x2,r1,r2|int.1}{mod1:Mod m x1 r1}{mod2:Mod m x2 r2}Mod m (plus_zed x1 x2) (plus_zed r1 r2)
  = [m,x1,x2,r1,r2|int.1][mod1:Mod m x1 r1][mod2:Mod m x2 r2]mod1 (Mod m (plus_zed x1 x2) (plus_zed r1 r2)) ([k1:int.1][eq1:eq%%int (plus_zed r1 (times_zed k1 m)) x1]mod2 (Mod m (plus_zed x1 x2) (plus_zed r1 r2)) ([k2:int.1][eq2:eq%%int (plus_zed r2 (times_zed k2 m)) x2]ExIntro%%int.1 (plus_zed k1 k2) ([k:int.1]eq%%int (plus_zed (plus_zed r1 r2) (times_zed k m)) (plus_zed x1 x2)) (Eq_trans_zed%%(plus_zed (plus_zed r1 r2) (times_zed (plus_zed k1 k2) m))%%(plus_zed (plus_zed r1 r2) (plus_zed (times_zed k1 m) (times_zed k2 m)))%%(plus_zed x1 x2) (plus_resp_eq (plus_zed r1 r2) (plus_zed r1 r2) (times_zed (plus_zed k1 k2) m) (plus_zed (times_zed k1 m) (times_zed k2 m)) (Eq_refl_zed (plus_zed r1 r2)) (times_plus_dist_r_zed%%k1%%k2%%m)) (Eq_trans_zed%%(plus_zed (plus_zed r1 r2) (plus_zed (times_zed k1 m) (times_zed k2 m)))%%(plus_zed (plus_zed r1 (times_zed k1 m)) (plus_zed r2 (times_zed k2 m)))%%(plus_zed x1 x2) (middle_four_plus_zed%%r1%%(times_zed k1 m)%%r2%%(times_zed k2 m)) (plus_resp_eq (plus_zed r1 (times_zed k1 m)) x1 (plus_zed r2 (times_zed k2 m)) x2 eq1 eq2)))))];
[times_resp_Mod : {m,x1,x2,r1,r2|int.1}(Mod m x1 r1)->(Mod m x2 r2)->Mod m (times_zed x1 x2) (times_zed r1 r2)
  = [m,x1,x2,r1,r2|int.1][H:Mod m x1 r1][H1:Mod m x2 r2]H (Mod m (times_zed x1 x2) (times_zed r1 r2)) ([k1:int.1][hyp1:eq%%int (plus_zed r1 (times_zed k1 m)) x1]H1 (Mod m (times_zed x1 x2) (times_zed r1 r2)) ([k2:int.1][hyp2:eq%%int (plus_zed r2 (times_zed k2 m)) x2]ExIn%%int.1 (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) ([k:int.1]eq%%int (plus_zed (times_zed r1 r2) (times_zed k m)) (times_zed x1 x2)) (Eq_trans_zed%%(plus_zed (times_zed r1 r2) (times_zed (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) m))%%(times_zed (plus_zed r1 (times_zed k1 m)) (plus_zed r2 (times_zed k2 m)))%%(times_zed x1 x2) (Eq_trans_zed%%(plus_zed (times_zed r1 r2) (times_zed (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) m))%%(plus_zed (times_zed (plus_zed r1 (times_zed k1 m)) r2) (times_zed (plus_zed r1 (times_zed k1 m)) (times_zed k2 m)))%%(times_zed (plus_zed r1 (times_zed k1 m)) (plus_zed r2 (times_zed k2 m))) (Eq_trans_zed%%(plus_zed (times_zed r1 r2) (times_zed (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) m))%%(plus_zed (plus_zed (times_zed r1 r2) (times_zed (times_zed k1 m) r2)) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))))%%(plus_zed (times_zed (plus_zed r1 (times_zed k1 m)) r2) (times_zed (plus_zed r1 (times_zed k1 m)) (times_zed k2 m))) (Eq_trans_zed%%(plus_zed (times_zed r1 r2) (times_zed (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) m))%%(plus_zed (times_zed r1 r2) (plus_zed (times_zed (times_zed k1 m) r2) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m)))))%%(plus_zed (plus_zed (times_zed r1 r2) (times_zed (times_zed k1 m) r2)) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m)))) (plus_resp_eq (times_zed r1 r2) (times_zed r1 r2) (times_zed (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) m) (plus_zed (times_zed (times_zed k1 m) r2) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m)))) (Eq_refl_zed (times_zed r1 r2)) (Eq_trans_zed%%(times_zed (plus_zed (times_zed k1 r2) (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))) m)%%(plus_zed (times_zed (times_zed k1 r2) m) (times_zed (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2)) m))%%(plus_zed (times_zed (times_zed k1 m) r2) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m)))) (times_plus_dist_r_zed%%(times_zed k1 r2)%%(plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2))%%m) (plus_resp_eq (times_zed (times_zed k1 r2) m) (times_zed (times_zed k1 m) r2) (times_zed (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2)) m) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))) (Eq_trans_zed%%(times_zed (times_zed k1 r2) m)%%(times_zed k1 (times_zed m r2))%%(times_zed (times_zed k1 m) r2) (Eq_trans_zed%%(times_zed (times_zed k1 r2) m)%%(times_zed k1 (times_zed r2 m))%%(times_zed k1 (times_zed m r2)) (times_assoc_zed%%k1%%r2%%m) (times_resp_eq k1 k1 (times_zed r2 m) (times_zed m r2) (Eq_refl_zed k1) (Eq_subst%%int.1%%(times_zed r2 m)%%(times_zed m r2) (times_commutes_zed|r2|m) (eq%%int (times_zed r2 m)) (Eq_refl_zed (times_zed r2 m))))) (Eq_sym_zed%%(times_zed (times_zed k1 m) r2)%%(times_zed k1 (times_zed m r2)) (times_assoc_zed%%k1%%m%%r2))) (Eq_trans_zed%%(times_zed (plus_zed (times_zed r1 k2) (times_zed (times_zed k1 m) k2)) m)%%(plus_zed (times_zed (times_zed r1 k2) m) (times_zed (times_zed (times_zed k1 m) k2) m))%%(plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))) (times_plus_dist_r_zed%%(times_zed r1 k2)%%(times_zed (times_zed k1 m) k2)%%m) (plus_resp_eq (times_zed (times_zed r1 k2) m) (times_zed r1 (times_zed k2 m)) (times_zed (times_zed (times_zed k1 m) k2) m) (times_zed (times_zed k1 m) (times_zed k2 m)) (times_assoc_zed%%r1%%k2%%m) (times_assoc_zed%%(times_zed k1 m)%%k2%%m)))))) (Eq_sym_zed%%(plus_zed (plus_zed (times_zed r1 r2) (times_zed (times_zed k1 m) r2)) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))))%%(plus_zed (times_zed r1 r2) (plus_zed (times_zed (times_zed k1 m) r2) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))))) (plus_assoc_zed%%(times_zed r1 r2)%%(times_zed (times_zed k1 m) r2)%%(plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m)))))) (plus_resp_eq (plus_zed (times_zed r1 r2) (times_zed (times_zed k1 m) r2)) (times_zed (plus_zed r1 (times_zed k1 m)) r2) (plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))) (times_zed (plus_zed r1 (times_zed k1 m)) (times_zed k2 m)) (Eq_sym_zed%%(times_zed (plus_zed r1 (times_zed k1 m)) r2)%%(plus_zed (times_zed r1 r2) (times_zed (times_zed k1 m) r2)) (times_plus_dist_r_zed%%r1%%(times_zed k1 m)%%r2)) (Eq_sym_zed%%(times_zed (plus_zed r1 (times_zed k1 m)) (times_zed k2 m))%%(plus_zed (times_zed r1 (times_zed k2 m)) (times_zed (times_zed k1 m) (times_zed k2 m))) (times_plus_dist_r_zed%%r1%%(times_zed k1 m)%%(times_zed k2 m))))) (Eq_sym_zed%%(times_zed (plus_zed r1 (times_zed k1 m)) (plus_zed r2 (times_zed k2 m)))%%(plus_zed (times_zed (plus_zed r1 (times_zed k1 m)) r2) (times_zed (plus_zed r1 (times_zed k1 m)) (times_zed k2 m))) (times_plus_dist_l_zed%%r2%%(times_zed k2 m)%%(plus_zed r1 (times_zed k1 m))))) (times_resp_eq (plus_zed r1 (times_zed k1 m)) x1 (plus_zed r2 (times_zed k2 m)) x2 hyp1 hyp2))))];
