Module lib_list_PermII Import "lib_list_length" "lib_rel_closure";
[insert : {A|Type(0)}{a:A}{h,k:list A}list A
  = [A|Type(0)][a:A][h,k:list A]append%%A h (cons%%A a k)];
[insertnil : {A|Type(0)}{a|A}{h,k|list A}{eq:Eq%%(list A) (insert%%A a h k) (nil A)}absurd
  = [A|Type(0)][a|A][h,k|list A]list_elim%%A ([h'5:list A]{eq:Eq%%(list A) (insert%%A a h'5 k) (nil A)}absurd) ([eq:Eq%%(list A) (insert%%A a (nil A) k) (nil A)]nil_not_cons%%A k a (Eq_sym%%(list A)%%(cons%%A a k)%%(nil A) eq)) ([x1:A][x2:list A][x2_ih:{eq:Eq%%(list A) (insert%%A a x2 k) (nil A)}absurd][eq:Eq%%(list A) (insert%%A a (cons%%A x1 x2) k) (nil A)]nil_not_cons%%A (list_elim%%A ([_:list A]list A) (cons%%A a k) ([y:A][_:list A]cons|A y) x2) x1 (Eq_sym%%(list A)%%(cons%%A x1 (list_elim%%A ([_:list A]list A) (cons%%A a k) ([y:A][_:list A]cons|A y) x2))%%(nil A) eq)) h];
[insertsingleton : {A|Type(0)}{a,b|A}{h,k|list A}(Eq%%(list A) (insert%%A a h k) (cons%%A b (nil A)))->and3 (Eq%%(list A) (nil A) h) (Eq%%A a b) (Eq%%(list A) (nil A) k)
  = [A|Type(0)][a,b|A][h,k|list A]list_elim%%A ([h'6:list A](Eq%%(list A) (insert%%A a h'6 k) (cons%%A b (nil A)))->and3 (Eq%%(list A) (nil A) h'6) (Eq%%A a b) (Eq%%(list A) (nil A) k)) ([H:Eq%%(list A) (insert%%A a (nil A) k) (cons%%A b (nil A))]cons_inj%%A%%a%%b%%k%%(nil A) H%%(and3 (Eq%%(list A) (nil A) (nil A)) (Eq%%A a b) (Eq%%(list A) (nil A) k)) ([eqab:Eq%%A a b][eqknil:Eq%%(list A) k (nil A)]pair3%%(Eq%%(list A) (nil A) (nil A))%%(Eq%%A a b)%%(Eq%%(list A) (nil A) k) (Eq_refl%%(list A) (nil A)) eqab (Eq_sym%%(list A)%%k%%(nil A) eqknil))) ([x1:A][x2:list A][x2_ih:(Eq%%(list A) (insert%%A a x2 k) (cons%%A b (nil A)))->and3 (Eq%%(list A) (nil A) x2) (Eq%%A a b) (Eq%%(list A) (nil A) k)][H:Eq%%(list A) (insert%%A a (cons%%A x1 x2) k) (cons%%A b (nil A))]cons_inj%%A%%x1%%b%%(list_elim%%A ([_:list A]list A) (cons%%A a k) ([y:A][_:list A]cons|A y) x2)%%(nil A) H%%(and3 (Eq%%(list A) (nil A) (cons%%A x1 x2)) (Eq%%A a b) (Eq%%(list A) (nil A) k)) ([H1:Eq%%A x1 b][H2:Eq%%(list A) (list_elim%%A ([_:list A]list A) (cons%%A a k) ([y:A][_:list A]cons|A y) x2) (nil A)]insertnil%%A%%a%%x2%%k H2 (and3 (Eq%%(list A) (nil A) (cons%%A x1 x2)) (Eq%%A a b) (Eq%%(list A) (nil A) k)))) h];
[insertapp : {A|Type(0)}{a|A}{h,k|list A}{l,m:list A}(Eq%%(list A) (insert%%A a h k) (append%%A l m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (append%%A n m) k)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi)
  = [A|Type(0)][a|A][h,k|list A]list_elim%%A ([h'5:list A]{k'6,l,m:list A}(Eq%%(list A) (insert%%A a h'5 k'6) (append%%A l m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h'5 n) l)->(Eq%%(list A) (append%%A n m) k'6)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A l n) h'5)->(Eq%%(list A) (insert%%A a n k'6) m)->phi)->phi)) ([k1,l:list A]list_elim%%A ([l'7:list A]{k'8,m:list A}(Eq%%(list A) (insert%%A a (nil A) k'8) (append%%A l'7 m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (nil A) n) l'7)->(Eq%%(list A) (append%%A n m) k'8)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A l'7 n) (nil A))->(Eq%%(list A) (insert%%A a n k'8) m)->phi)->phi)) ([k2,m:list A][H:Eq%%(list A) (insert%%A a (nil A) k2) (append%%A (nil A) m)]inr%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (nil A) n) (nil A))->(Eq%%(list A) (append%%A n m) k2)->phi)->phi)%%({phi:Prop}({n:list A}(Eq%%(list A) (append%%A (nil A) n) (nil A))->(Eq%%(list A) (insert%%A a n k2) m)->phi)->phi) ([phi:Prop][H1:{n:list A}(Eq%%(list A) (append%%A (nil A) n) (nil A))->(Eq%%(list A) (insert%%A a n k2) m)->phi]H1 (nil A) (Eq_refl%%(list A) (append%%A (nil A) (nil A))) H)) ([b1:A][x2:list A][x2_ih:{k'9,m:list A}(Eq%%(list A) (insert%%A a (nil A) k'9) (append%%A x2 m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (nil A) n) x2)->(Eq%%(list A) (append%%A n m) k'9)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A x2 n) (nil A))->(Eq%%(list A) (insert%%A a n k'9) m)->phi)->phi)][k2,m:list A][H:Eq%%(list A) (insert%%A a (nil A) k2) (append%%A (cons%%A b1 x2) m)]inl%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (nil A) n) (cons%%A b1 x2))->(Eq%%(list A) (append%%A n m) k2)->phi)->phi)%%({phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b1 x2) n) (nil A))->(Eq%%(list A) (insert%%A a n k2) m)->phi)->phi) ([phi:Prop][H1:{n:list A}(Eq%%(list A) (insert%%A a (nil A) n) (cons%%A b1 x2))->(Eq%%(list A) (append%%A n m) k2)->phi]cons_inj%%A%%a%%b1%%k2%%(list_elim%%A ([_:list A]list A) m ([y:A][_:list A]cons|A y) x2) H%%phi ([aeqb1:Eq%%A a b1][decomp:Eq%%(list A) k2 (append%%A x2 m)]H1 x2 (Eq_subst%%A%%b1%%a (Eq_sym%%A%%a%%b1 aeqb1) ([z:A]Eq%%(list A) (insert%%A z (nil A) x2) (cons%%A b1 x2)) (Eq_refl%%(list A) (insert%%A b1 (nil A) x2))) (Eq_sym%%(list A)%%k2%%(append%%A x2 m) decomp)))) l k1) ([b1:A][k1:list A][x2_ih:{k'7,l,m:list A}(Eq%%(list A) (insert%%A a k1 k'7) (append%%A l m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a k1 n) l)->(Eq%%(list A) (append%%A n m) k'7)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A l n) k1)->(Eq%%(list A) (insert%%A a n k'7) m)->phi)->phi)][k2,l,m:list A][H:Eq%%(list A) (insert%%A a (cons%%A b1 k1) k2) (append%%A l m)]list_elim%%A ([l'12:list A]{m'13:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) k2) (append%%A l'12 m'13))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) l'12)->(Eq%%(list A) (append%%A n m'13) k2)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A l'12 n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m'13)->phi)->phi)) ([m1:list A][H1:Eq%%(list A) (insert%%A a (cons%%A b1 k1) k2) (append%%A (nil A) m1)]inr%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) (nil A))->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi)%%({phi:Prop}({n:list A}(Eq%%(list A) (append%%A (nil A) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi) ([phi:Prop][H2:{n:list A}(Eq%%(list A) (append%%A (nil A) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi]H2 (cons%%A b1 k1) (Eq_refl%%(list A) (append%%A (nil A) (cons%%A b1 k1))) H1)) ([b2:A][k3:list A][x2_ih1:{m'14:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) k2) (append%%A k3 m'14))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) k3)->(Eq%%(list A) (append%%A n m'14) k2)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A k3 n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m'14)->phi)->phi)][m1:list A][H1:Eq%%(list A) (insert%%A a (cons%%A b1 k1) k2) (append%%A (cons%%A b2 k3) m1)]cons_inj%%A%%b1%%b2%%(list_elim%%A ([_:list A]list A) (cons%%A a k2) ([y:A][_:list A]cons|A y) k1)%%(list_elim%%A ([_:list A]list A) m1 ([y:A][_:list A]cons|A y) k3) H1%%(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) (cons%%A b2 k3))->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b2 k3) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi) ([b1eqb2:Eq%%A b1 b2][decomp:Eq%%(list A) (list_elim%%A ([_:list A]list A) (cons%%A a k2) ([y:A][_:list A]cons|A y) k1) (list_elim%%A ([_:list A]list A) m1 ([y:A][_:list A]cons|A y) k3)]x2_ih k2 k3 m1 decomp%%(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) (cons%%A b2 k3))->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi) \/ {phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b2 k3) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi) ([H2:{phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a k1 n) k3)->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi]inl%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) (cons%%A b2 k3))->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi)%%({phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b2 k3) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi) (H2 ({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) (cons%%A b2 k3))->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi) ([n:list A][H3:Eq%%(list A) (insert%%A a k1 n) k3][H4:Eq%%(list A) (append%%A n m1) k2][phi:Prop][H5:{n'24:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n'24) (cons%%A b2 k3))->(Eq%%(list A) (append%%A n'24 m1) k2)->phi]H5 n (Eq_subst%%A%%b2%%b1 (Eq_sym%%A%%b1%%b2 b1eqb2) ([z:A]Eq%%(list A) (insert%%A a (cons%%A z k1) n) (cons%%A b2 k3)) (Eq_resp%%(list A)%%(list A) (cons%%A b2)%%(list_elim%%A ([_:list A]list A) (cons%%A a n) ([y:A][_:list A]cons|A y) k1)%%k3 H3)) H4))) ([H2:{phi:Prop}({n:list A}(Eq%%(list A) (append%%A k3 n) k1)->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi]inr%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a (cons%%A b1 k1) n) (cons%%A b2 k3))->(Eq%%(list A) (append%%A n m1) k2)->phi)->phi)%%({phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b2 k3) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi) (H2 ({phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b2 k3) n) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n k2) m1)->phi)->phi) ([n:list A][H3:Eq%%(list A) (append%%A k3 n) k1][H4:Eq%%(list A) (insert%%A a n k2) m1][phi:Prop][H5:{n'24:list A}(Eq%%(list A) (append%%A (cons%%A b2 k3) n'24) (cons%%A b1 k1))->(Eq%%(list A) (insert%%A a n'24 k2) m1)->phi]H5 n (Eq_subst%%A%%b2%%b1 (Eq_sym%%A%%b1%%b2 b1eqb2) ([z:A]Eq%%(list A) (append%%A (cons%%A b2 k3) n) (cons%%A z k1)) (Eq_resp%%(list A)%%(list A) (cons%%A b2)%%(list_elim%%A ([_:list A]list A) n ([y:A][_:list A]cons|A y) k3)%%k1 H3)) H4))))) l m H) h k];
[inseqins : {A|Type(0)}{a|A}{h,k,l,m|list A}(Eq%%(list A) (insert%%A a h k) (insert%%A a l m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi) \/ ((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi))
  = [A|Type(0)][a|A][h,k,l,m|list A][H:Eq%%(list A) (insert%%A a h k) (insert%%A a l m)]insertapp%%A%%a%%h%%k l (cons%%A a m) H%%(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi) \/ ((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi)) ([H1:{phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (append%%A n (cons%%A a m)) k)->phi)->phi]H1 (({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi) \/ ((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi)) ([n:list A][H2:Eq%%(list A) (insert%%A a h n) l][H3:Eq%%(list A) (append%%A n (cons%%A a m)) k]inl%%({phi:Prop}({n'13:list A}(Eq%%(list A) (insert%%A a h n'13) l)->(Eq%%(list A) (insert%%A a n'13 m) k)->phi)->phi)%%((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n'13:list A}(Eq%%(list A) (insert%%A a l n'13) h)->(Eq%%(list A) (insert%%A a n'13 k) m)->phi)->phi) ([phi:Prop][H4:{n'13:list A}(Eq%%(list A) (insert%%A a h n'13) l)->(Eq%%(list A) (insert%%A a n'13 m) k)->phi]H4 n H2 H3))) ([H1:{phi:Prop}({n:list A}(Eq%%(list A) (append%%A l n) h)->(Eq%%(list A) (insert%%A a n k) (cons%%A a m))->phi)->phi]H1 (({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi) \/ ((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi)) (list_elim%%A ([n:list A](Eq%%(list A) (append%%A l n) h)->(Eq%%(list A) (insert%%A a n k) (cons%%A a m))->(({phi:Prop}({n'13:list A}(Eq%%(list A) (insert%%A a h n'13) l)->(Eq%%(list A) (insert%%A a n'13 m) k)->phi)->phi) \/ ((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n'13:list A}(Eq%%(list A) (insert%%A a l n'13) h)->(Eq%%(list A) (insert%%A a n'13 k) m)->phi)->phi))) ([H2:Eq%%(list A) (append%%A l (nil A)) h][H3:Eq%%(list A) (insert%%A a (nil A) k) (cons%%A a m)]inr%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi)%%((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi) (inl%%(Eq%%(list A) l h /\ Eq%%(list A) k m)%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi) (pair%%(Eq%%(list A) l h)%%(Eq%%(list A) k m) (Eq_trans%%(list A)%%l%%(append%%A l (nil A))%%h (Eq_sym%%(list A)%%(append%%A l (nil A))%%l (append_nil%%A l)) H2) (cons_inj%%A%%a%%a%%k%%m H3%%(Eq%%(list A) k m) ([H4:Eq%%A a a][H5:Eq%%(list A) k m]H5))))) ([b1:A][k1:list A][x2_ih:(Eq%%(list A) (append%%A l k1) h)->(Eq%%(list A) (insert%%A a k1 k) (cons%%A a m))->(({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi) \/ ((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi))][H2:Eq%%(list A) (append%%A l (cons%%A b1 k1)) h][H3:Eq%%(list A) (insert%%A a (cons%%A b1 k1) k) (cons%%A a m)]inr%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) l)->(Eq%%(list A) (insert%%A a n m) k)->phi)->phi)%%((Eq%%(list A) l h /\ Eq%%(list A) k m) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi) (inr%%(Eq%%(list A) l h /\ Eq%%(list A) k m)%%({phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi)->phi) ([phi:Prop][H4:{n:list A}(Eq%%(list A) (insert%%A a l n) h)->(Eq%%(list A) (insert%%A a n k) m)->phi]cons_inj%%A%%b1%%a%%(list_elim%%A ([_:list A]list A) (cons%%A a k) ([y:A][_:list A]cons|A y) k1)%%m H3%%phi ([b1eqa:Eq%%A b1 a][decomp:Eq%%(list A) (list_elim%%A ([_:list A]list A) (cons%%A a k) ([y:A][_:list A]cons|A y) k1) m]H4 k1 (Eq_subst%%A%%b1%%a (Eq_sym%%A%%a%%b1 (Eq_sym%%A%%b1%%a b1eqa)) ([z:A]Eq%%(list A) (insert%%A z l k1) h) H2) decomp))))))];
[swap : {A|Type(0)}{S:Rel (list A) (list A)}Prop
  = [A|Type(0)][S:Rel (list A) (list A)]{l,m:list A}S (append%%A l m) (append%%A m l)];
[conscl : {A|Type(0)}{a:A}{S:Rel (list A) (list A)}{m,n:list A}Prop
  = [A|Type(0)][a:A][S:Rel (list A) (list A)][m,n:list A]S (cons%%A a m) (cons%%A a n)];
[consClosed : {A|Type(0)}{S:Rel (list A) (list A)}Prop
  = [A|Type(0)][S:Rel (list A) (list A)]{a:A}SubRel%%(list A)%%(list A) S (conscl%%A a S)];
[iclSwap : {A|Type(0)}IntersectionClosed%%(list A)%%(list A) (swap%%A)
  = [A|Type(0)][G:Pred (Rel (list A) (list A))][GsubF:SubPred%%(Rel (list A) (list A)) G (swap%%A)][l,m:list A][R:Rel (list A) (list A)][FR:G R]GsubF%%R FR l m];
[iclConscl : {A|Type(0)}IntersectionClosed%%(list A)%%(list A) (consClosed%%A)
  = [A|Type(0)][G:Pred (Rel (list A) (list A))][GsubF:SubPred%%(Rel (list A) (list A)) G (consClosed%%A)][a:A][x,y|list A][hyp:intersectionRel%%(list A)%%(list A) G x y][R:Rel (list A) (list A)][FR:G R]GsubF%%R FR a%%x%%y (hyp R FR)];
[Fbase : {A|Type(0)}Pred (Rel (list A) (list A))
  = [A|Type(0)]andPred%%(Rel (list A) (list A)) (swap%%A) (consClosed%%A)];
[iclBase : {A|Type(0)}IntersectionClosed%%(list A)%%(list A) (Fbase%%A)
  = [A|Type(0)]iclAnd%%(list A)%%(list A) (swap%%A) (iclSwap%%A) (consClosed%%A) (iclConscl%%A)];
[PermBase : {A|Type(0)}Rel (list A) (list A)
  = [A|Type(0)]intersectionRel%%(list A)%%(list A) (Fbase%%A)];
[swapBase : {A|Type(0)}swap%%A (PermBase%%A)
  = [A|Type(0)]fst%%(swap%%A (intersectionRel%%(list A)%%(list A) (Fbase%%A)))%%(consClosed%%A (intersectionRel%%(list A)%%(list A) (Fbase%%A))) (intFhasF%%(list A)%%(list A) (Fbase%%A) (iclBase%%A))];
[consclBase : {A|Type(0)}consClosed%%A (PermBase%%A)
  = [A|Type(0)]snd%%(swap%%A (intersectionRel%%(list A)%%(list A) (Fbase%%A)))%%(consClosed%%A (intersectionRel%%(list A)%%(list A) (Fbase%%A))) (intFhasF%%(list A)%%(list A) (Fbase%%A) (iclBase%%A))];
[Perm : {A|Type(0)}Rel (list A) (list A)
  = [A|Type(0)]closure%%(list A)%%(list A) (equiv|(list A)) (PermBase%%A)];
[equivPerm : {A|Type(0)}equiv%%(list A) (Perm%%A)
  = [A|Type(0)]closureI%%(list A)%%(list A) (equiv%%(list A)) (iclEquiv%%(list A))%%(PermBase%%A)];
[reflPerm : {A|Type(0)}refl%%(list A) (Perm%%A)
  = [A|Type(0)]fst%%(refl%%(list A) (Perm%%A))%%(per%%(list A) (Perm%%A)) (equivPerm%%A)];
[symPerm : {A|Type(0)}sym%%(list A) (Perm%%A)
  = [A|Type(0)]fst%%(sym%%(list A) (Perm%%A))%%(trans%%(list A) (Perm%%A)) (snd%%(refl%%(list A) (Perm%%A))%%(per%%(list A) (Perm%%A)) (equivPerm%%A))];
[transPerm : {A|Type(0)}trans%%(list A) (Perm%%A)
  = [A|Type(0)]snd%%(sym%%(list A) (Perm%%A))%%(trans%%(list A) (Perm%%A)) (snd%%(refl%%(list A) (Perm%%A))%%(per%%(list A) (Perm%%A)) (equivPerm%%A))];
[reflPerm' : {A|Type(0)}SubRel%%(list A)%%(list A) (Eq|(list A)) (Perm%%A)
  = [A|Type(0)][x,y|list A][hyp:Eq|(list A) x y][R:Rel (list A) (list A)][FR:andPred%%(Rel (list A) (list A)) (equiv|(list A)) (SubRel%%(list A)%%(list A) (PermBase%%A)) R]Eq_subst%%(list A)%%y%%x (Eq_sym%%(list A)%%x%%y hyp) ([z:list A]R z y) (reflPerm%%A y R FR)];
[swapPerm : {A|Type(0)}swap%%A (Perm%%A)
  = [A|Type(0)][l,m:list A][R:Rel (list A) (list A)][FR:andPred%%(Rel (list A) (list A)) (equiv|(list A)) (SubRel%%(list A)%%(list A) (PermBase%%A)) R]FR%%(R (append%%A l m) (append%%A m l)) ([H:equiv|(list A) R][H1:SubRel%%(list A)%%(list A) (PermBase%%A) R]H1%%(append%%A l m)%%(append%%A m l) (swapBase%%A l m))];
[consclPerm : {A|Type(0)}consClosed%%A (Perm%%A)
  = [A|Type(0)][a:A]closureE%%(list A)%%(list A) (equiv|(list A))%%(PermBase%%A)%%(conscl%%A a (Perm%%A)) (pair%%(refl%%(list A) (conscl%%A a (Perm%%A)))%%(per%%(list A) (conscl%%A a (Perm%%A))) ([l:list A]reflPerm%%A (cons%%A a l)) (pair%%(sym%%(list A) (conscl%%A a (Perm%%A)))%%(trans%%(list A) (conscl%%A a (Perm%%A))) ([l,m|list A][symhyp:conscl%%A a (Perm%%A) l m]symPerm%%A%%(cons%%A a l)%%(cons%%A a m) symhyp) ([l,m,n|list A][lthyp:conscl%%A a (Perm%%A) l m][rthyp:conscl%%A a (Perm%%A) m n]transPerm%%A%%(cons%%A a l)%%(cons%%A a m)%%(cons%%A a n) lthyp rthyp))) ([l,m|list A][hyp:PermBase%%A l m]closureInc%%(list A)%%(list A) (equiv|(list A))%%(PermBase%%A)%%(cons%%A a l)%%(cons%%A a m) (consclBase%%A a%%l%%m hyp))];
[appcl : {A|Type(0)}{l:list A}{S:Rel (list A) (list A)}{m,n:list A}Prop
  = [A|Type(0)][l:list A][S:Rel (list A) (list A)][m,n:list A]S (append%%A l m) (append%%A l n)];
[appClosed : {A|Type(0)}{S:Rel (list A) (list A)}Prop
  = [A|Type(0)][S:Rel (list A) (list A)]{l:list A}SubRel%%(list A)%%(list A) S (appcl%%A l S)];
[iclAppcl : {A|Type(0)}IntersectionClosed%%(list A)%%(list A) (appClosed%%A)
  = [A|Type(0)][G:Pred (Rel (list A) (list A))][GsubF:SubPred%%(Rel (list A) (list A)) G (appClosed%%A)][l:list A][x,y|list A][hyp:intersectionRel%%(list A)%%(list A) G x y][R:Rel (list A) (list A)][FR:G R]GsubF%%R FR l%%x%%y (hyp R FR)];
[appclPerm : {A|Type(0)}appClosed%%A (Perm%%A)
  = [A|Type(0)]list_elim%%A ([l:list A]SubRel%%(list A)%%(list A) (Perm%%A) (appcl%%A l (Perm%%A))) ([x,y|list A][hyp:Perm%%A x y]hyp) ([x1:A][x2:list A][x2_ih:SubRel%%(list A)%%(list A) (Perm%%A) (appcl%%A x2 (Perm%%A))][x,y|list A][hyp:Perm%%A x y]consclPerm%%A x1%%(list_elim%%A ([_:list A]list A) x ([y'8:A][_:list A]cons|A y'8) x2)%%(list_elim%%A ([_:list A]list A) y ([y'8:A][_:list A]cons|A y'8) x2) (x2_ih%%x%%y hyp))];
[recPerm : {A|Type(0)}{l,m:list A}{perm_hyp:Perm%%A l m}{R:Rel (list A) (list A)}{reflR:{l'6:list A}R l'6 l'6}{symR:{l'7,m'8:list A}{sym_prem:Perm%%A l'7 m'8}{sym_ih:R l'7 m'8}R m'8 l'7}{transR:{l'8,m'9,n:list A}{lt_prem:Perm%%A l'8 m'9}{lt_ih:R l'8 m'9}{rt_prem:Perm%%A m'9 n}{rt_ih:R m'9 n}R l'8 n}{swapR:{l'9,m'10:list A}R (append%%A l'9 m'10) (append%%A m'10 l'9)}{consclR:{a:A}{m'11,n:list A}{cons_prem:Perm%%A m'11 n}{cons_ih:R m'11 n}R (cons%%A a m'11) (cons%%A a n)}R l m
  = [A|Type(0)][l,m:list A][perm_hyp:Perm%%A l m][R:Rel (list A) (list A)][reflR:{l'6:list A}R l'6 l'6][symR:{l'7,m'8:list A}{sym_prem:Perm%%A l'7 m'8}{sym_ih:R l'7 m'8}R m'8 l'7][transR:{l'8,m'9,n:list A}{lt_prem:Perm%%A l'8 m'9}{lt_ih:R l'8 m'9}{rt_prem:Perm%%A m'9 n}{rt_ih:R m'9 n}R l'8 n][swapR:{l'9,m'10:list A}R (append%%A l'9 m'10) (append%%A m'10 l'9)][consclR:{a:A}{m'11,n:list A}{cons_prem:Perm%%A m'11 n}{cons_ih:R m'11 n}R (cons%%A a m'11) (cons%%A a n)]perm_hyp (andRel%%(list A)%%(list A) (Perm%%A) R) (pair%%(equiv|(list A) (andRel%%(list A)%%(list A) (Perm%%A) R))%%(SubRel%%(list A)%%(list A) (PermBase%%A) (andRel%%(list A)%%(list A) (Perm%%A) R)) (pair%%(refl%%(list A) (andRel%%(list A)%%(list A) (Perm%%A) R))%%(per%%(list A) (andRel%%(list A)%%(list A) (Perm%%A) R)) ([t:list A]pair%%(Perm%%A t t)%%(R t t) (reflPerm%%A t) (reflR t)) (pair%%(sym%%(list A) (andRel%%(list A)%%(list A) (Perm%%A) R))%%(trans%%(list A) (andRel%%(list A)%%(list A) (Perm%%A) R)) ([t,u|list A][H:andRel%%(list A)%%(list A) (Perm%%A) R t u]H%%(andRel%%(list A)%%(list A) (Perm%%A) R u t) ([H1:Perm%%A t u][H2:R t u]pair%%(Perm%%A u t)%%(R u t) (symPerm%%A%%t%%u H1) (symR t u H1 H2))) ([t,u,v|list A][H:andRel%%(list A)%%(list A) (Perm%%A) R t u][H1:andRel%%(list A)%%(list A) (Perm%%A) R u v]H%%(andRel%%(list A)%%(list A) (Perm%%A) R t v) ([H2:Perm%%A t u][H3:R t u]H1%%(andRel%%(list A)%%(list A) (Perm%%A) R t v) ([H4:Perm%%A u v][H5:R u v]pair%%(Perm%%A t v)%%(R t v) (transPerm%%A%%t%%u%%v H2 H4) (transR t u v H2 H3 H4 H5)))))) (andRelI%%(list A)%%(list A)%%(Perm%%A)%%R%%(PermBase%%A) (closureInc%%(list A)%%(list A) (equiv|(list A))%%(PermBase%%A)) ([l1,m1|list A][base_hyp:PermBase%%A l1 m1]base_hyp (andRel%%(list A)%%(list A) (Perm%%A) R) (pair%%(swap%%A (andRel%%(list A)%%(list A) (Perm%%A) R))%%(consClosed%%A (andRel%%(list A)%%(list A) (Perm%%A) R)) ([l2,m2:list A]pair%%(Perm%%A (append%%A l2 m2) (append%%A m2 l2))%%(R (append%%A l2 m2) (append%%A m2 l2)) (swapPerm%%A l2 m2) (swapR l2 m2)) ([a:A][l2,m2|list A][cons_hyp:andRel%%(list A)%%(list A) (Perm%%A) R l2 m2]cons_hyp%%(conscl%%A a (andRel%%(list A)%%(list A) (Perm%%A) R) l2 m2) ([H:Perm%%A l2 m2][H1:R l2 m2]pair%%(Perm%%A (cons%%A a l2) (cons%%A a m2))%%(R (cons%%A a l2) (cons%%A a m2)) (consclPerm%%A a%%l2%%m2 H) (consclR a l2 m2 H H1))))%%(R l1 m1) ([H:Perm%%A l1 m1][H1:R l1 m1]H1))))%%(R l m) ([H:Perm%%A l m][H1:R l m]H1)];
[PermE : {A|Type(0)}{R:Rel (list A) (list A)}{reflR:{l,m|list A}{eq_prem:Eq%%(list A) l m}R l m}{symR:{l,m|list A}{sym_prem:Perm%%A l m}{sym_ih:R l m}R m l}{transR:{l,m,n|list A}{lt_prem:Perm%%A l m}{lt_ih:R l m}{rt_prem:Perm%%A m n}{rt_ih:R m n}R l n}{swapR:{l,m|list A}R (append%%A l m) (append%%A m l)}{consclR:{a|A}{m,n|list A}{cons_prem:Perm%%A m n}{cons_ih:R m n}R (cons%%A a m) (cons%%A a n)}SubRel%%(list A)%%(list A) (Perm%%A) R
  = [A|Type(0)][R:Rel (list A) (list A)][reflR:{l,m|list A}{eq_prem:Eq%%(list A) l m}R l m][symR:{l,m|list A}{sym_prem:Perm%%A l m}{sym_ih:R l m}R m l][transR:{l,m,n|list A}{lt_prem:Perm%%A l m}{lt_ih:R l m}{rt_prem:Perm%%A m n}{rt_ih:R m n}R l n][swapR:{l,m|list A}R (append%%A l m) (append%%A m l)][consclR:{a|A}{m,n|list A}{cons_prem:Perm%%A m n}{cons_ih:R m n}R (cons%%A a m) (cons%%A a n)][x,y|list A][hyp:Perm%%A x y]recPerm%%A x y hyp R ([l:list A]reflR%%l%%l (Eq_refl%%(list A) l)) symR transR swapR consclR];
[indPerm : {A|Type(0)}Rel (list A) (list A)
  = [A|Type(0)][l,m:list A]{phi:Prop}((Eq%%(list A) l m)->phi)->((Perm%%A m l)->phi)->({k:list A}(Perm%%A l k)->(Perm%%A k m)->phi)->({h,k:list A}(Eq%%(list A) (append%%A h k) l)->(Eq%%(list A) (append%%A k h) m)->phi)->({a:A}{h,k:list A}(Eq%%(list A) (cons%%A a h) l)->(Eq%%(list A) (cons%%A a k) m)->(Perm%%A h k)->phi)->phi];
[PermIsInductive : {A|Type(0)}SubRel%%(list A)%%(list A) (Perm%%A) (indPerm%%A)
  = [A|Type(0)]PermE%%A (indPerm%%A) ([l,m|list A][eq_prem:Eq%%(list A) l m][phi:Prop][H:(Eq%%(list A) l m)->phi][H1:(Perm%%A m l)->phi][H2:{k:list A}(Perm%%A l k)->(Perm%%A k m)->phi][H3:{h,k:list A}(Eq%%(list A) (append%%A h k) l)->(Eq%%(list A) (append%%A k h) m)->phi][H4:{a:A}{h,k:list A}(Eq%%(list A) (cons%%A a h) l)->(Eq%%(list A) (cons%%A a k) m)->(Perm%%A h k)->phi]H eq_prem) ([l,m|list A][sym_prem:Perm%%A l m][sym_ih:indPerm%%A l m][phi:Prop][H:(Eq%%(list A) m l)->phi][H1:(Perm%%A l m)->phi][H2:{k:list A}(Perm%%A m k)->(Perm%%A k l)->phi][H3:{h,k:list A}(Eq%%(list A) (append%%A h k) m)->(Eq%%(list A) (append%%A k h) l)->phi][H4:{a:A}{h,k:list A}(Eq%%(list A) (cons%%A a h) m)->(Eq%%(list A) (cons%%A a k) l)->(Perm%%A h k)->phi]H1 sym_prem) ([l,m,n|list A][lt_prem:Perm%%A l m][lt_ih:indPerm%%A l m][rt_prem:Perm%%A m n][rt_ih:indPerm%%A m n][phi:Prop][H:(Eq%%(list A) l n)->phi][H1:(Perm%%A n l)->phi][H2:{k:list A}(Perm%%A l k)->(Perm%%A k n)->phi][H3:{h,k:list A}(Eq%%(list A) (append%%A h k) l)->(Eq%%(list A) (append%%A k h) n)->phi][H4:{a:A}{h,k:list A}(Eq%%(list A) (cons%%A a h) l)->(Eq%%(list A) (cons%%A a k) n)->(Perm%%A h k)->phi]H2 m lt_prem rt_prem) ([l,m|list A][phi:Prop][H:(Eq%%(list A) (append%%A l m) (append%%A m l))->phi][H1:(Perm%%A (append%%A m l) (append%%A l m))->phi][H2:{k:list A}(Perm%%A (append%%A l m) k)->(Perm%%A k (append%%A m l))->phi][H3:{h,k:list A}(Eq%%(list A) (append%%A h k) (append%%A l m))->(Eq%%(list A) (append%%A k h) (append%%A m l))->phi][H4:{a:A}{h,k:list A}(Eq%%(list A) (cons%%A a h) (append%%A l m))->(Eq%%(list A) (cons%%A a k) (append%%A m l))->(Perm%%A h k)->phi]H3 l m (Eq_refl%%(list A) (append%%A l m)) (Eq_refl%%(list A) (append%%A m l))) ([a|A][m,n|list A][cons_prem:Perm%%A m n][cons_ih:indPerm%%A m n][phi:Prop][H:(Eq%%(list A) (cons%%A a m) (cons%%A a n))->phi][H1:(Perm%%A (cons%%A a n) (cons%%A a m))->phi][H2:{k:list A}(Perm%%A (cons%%A a m) k)->(Perm%%A k (cons%%A a n))->phi][H3:{h,k:list A}(Eq%%(list A) (append%%A h k) (cons%%A a m))->(Eq%%(list A) (append%%A k h) (cons%%A a n))->phi][H4:{a'12:A}{h,k:list A}(Eq%%(list A) (cons%%A a'12 h) (cons%%A a m))->(Eq%%(list A) (cons%%A a'12 k) (cons%%A a n))->(Perm%%A h k)->phi]H4 a m n (Eq_refl%%(list A) (cons%%A a m)) (Eq_refl%%(list A) (cons%%A a n)) cons_prem)];
[PermRrespR : {A|Type(0)}{B|Type}{R:Rel B (list A)}{swapR:{l,m:list A}{h:B}(R h (append%%A l m))->R h (append%%A m l)}{consclR:{b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:{h:B}(R h l)->R h m}{k:B}(R k (cons%%A b l))->R k (cons%%A b m)}SubRel%%(list A)%%(list A) (Perm%%A) (impliesRel%%B%%(list A)%%(list A) R R)
  = [A|Type(0)][B|Type][R:Rel B (list A)][swapR:{l,m:list A}{h:B}(R h (append%%A l m))->R h (append%%A m l)][consclR:{b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:{h:B}(R h l)->R h m}{k:B}(R k (cons%%A b l))->R k (cons%%A b m)][kerR=andRel%%(list A)%%(list A) (impliesRel%%B%%(list A)%%(list A) R R) (coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R))]transSubRel%%(list A)%%(list A)%%(Perm%%A)%%kerR%%(impliesRel%%B%%(list A)%%(list A) R R) (PermE%%A kerR ([l,m|list A][eq_prem:Eq%%(list A) l m]pair%%(impliesRel%%B%%(list A)%%(list A) R R l m)%%(coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) l m) ([x:B][hypR:R x l]Eq_subst%%(list A)%%l%%m (Eq_sym%%(list A)%%m%%l (Eq_sym%%(list A)%%l%%m eq_prem)) ([z:list A]R x z) hypR) ([z:B][hypS:op%%B%%(list A) R m z]Eq_subst%%(list A)%%m%%l (Eq_sym%%(list A)%%l%%m eq_prem) ([z'1:list A]op%%B%%(list A) R z'1 z) hypS)) ([l,m|list A][sym_prem:Perm%%A l m][sym_ih:kerR l m]sym_ih%%(kerR m l) ([H:impliesRel%%B%%(list A)%%(list A) R R l m][H1:coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) l m]pair%%(impliesRel%%B%%(list A)%%(list A) R R m l)%%(coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) m l) ([x:B][hypR:R x m]H1 x hypR) ([z:B][hypS:op%%B%%(list A) R l z]H z hypS))) ([l,m,n|list A][lt_prem:Perm%%A l m][lt_ih:kerR l m][rt_prem:Perm%%A m n][rt_ih:kerR m n]lt_ih%%(kerR l n) ([H:impliesRel%%B%%(list A)%%(list A) R R l m][H1:coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) l m]rt_ih%%(kerR l n) ([H2:impliesRel%%B%%(list A)%%(list A) R R m n][H3:coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) m n]pair%%(impliesRel%%B%%(list A)%%(list A) R R l n)%%(coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) l n) ([x:B][hypR:R x l]H2 x (H x hypR)) ([z:B][hypS:op%%B%%(list A) R n z]H1 z (H3 z hypS))))) ([l,m|list A]pair%%(impliesRel%%B%%(list A)%%(list A) R R (append%%A l m) (append%%A m l))%%(coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) (append%%A l m) (append%%A m l)) (swapR l m) (swapR m l)) ([a|A][m,n|list A][cons_prem:Perm%%A m n][cons_ih:kerR m n]cons_ih%%(kerR (cons%%A a m) (cons%%A a n)) ([H:impliesRel%%B%%(list A)%%(list A) R R m n][H1:coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) m n]pair%%(impliesRel%%B%%(list A)%%(list A) R R (cons%%A a m) (cons%%A a n))%%(coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R) (cons%%A a m) (cons%%A a n)) ([x:B][hypR:R x (cons%%A a m)]consclR a m n cons_prem H x hypR) ([z:B][hypS:op%%B%%(list A) R (cons%%A a n) z]consclR a n m (symPerm%%A%%m%%n cons_prem) H1 z hypS)))) (andRelE1%%(list A)%%(list A)%%(impliesRel%%B%%(list A)%%(list A) R R)%%(coimpliesRel%%(list A)%%(list A)%%B (op%%B%%(list A) R) (op%%B%%(list A) R))%%kerR (reflSubRel%%(list A)%%(list A) kerR))];
[PermLrespR : {A|Type(0)}{B|Type}{R:Rel (list A) B}{swapR:{l,m:list A}{h:B}(R (append%%A l m) h)->R (append%%A m l) h}{consclR:{b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:{h:B}(R l h)->R m h}{k:B}(R (cons%%A b l) k)->R (cons%%A b m) k}SubRel%%(list A)%%(list A) (Perm%%A) (coimpliesRel%%(list A)%%(list A)%%B R R)
  = [A|Type(0)][B|Type][R:Rel (list A) B][swapR:{l,m:list A}{h:B}(R (append%%A l m) h)->R (append%%A m l) h][consclR:{b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:{h:B}(R l h)->R m h}{k:B}(R (cons%%A b l) k)->R (cons%%A b m) k][kerR=andRel%%(list A)%%(list A) (coimpliesRel%%(list A)%%(list A)%%B R R) (impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R))]transSubRel%%(list A)%%(list A)%%(Perm%%A)%%kerR%%(coimpliesRel%%(list A)%%(list A)%%B R R) (PermE%%A kerR ([l,m|list A][eq_prem:Eq%%(list A) l m]pair%%(coimpliesRel%%(list A)%%(list A)%%B R R l m)%%(impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) l m) ([z:B][hypS:R m z]Eq_subst%%(list A)%%m%%l (Eq_sym%%(list A)%%l%%m eq_prem) ([z'1:list A]R z'1 z) hypS) ([x:B][hypR:op%%(list A)%%B R x l]Eq_subst%%(list A)%%l%%m (Eq_sym%%(list A)%%m%%l (Eq_sym%%(list A)%%l%%m eq_prem)) ([z:list A]op%%(list A)%%B R x z) hypR)) ([l,m|list A][sym_prem:Perm%%A l m][sym_ih:kerR l m]sym_ih%%(kerR m l) ([H:coimpliesRel%%(list A)%%(list A)%%B R R l m][H1:impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) l m]pair%%(coimpliesRel%%(list A)%%(list A)%%B R R m l)%%(impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) m l) ([z:B][hypS:R l z]H1 z hypS) ([x:B][hypR:op%%(list A)%%B R x m]H x hypR))) ([l,m,n|list A][lt_prem:Perm%%A l m][lt_ih:kerR l m][rt_prem:Perm%%A m n][rt_ih:kerR m n]lt_ih%%(kerR l n) ([H:coimpliesRel%%(list A)%%(list A)%%B R R l m][H1:impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) l m]rt_ih%%(kerR l n) ([H2:coimpliesRel%%(list A)%%(list A)%%B R R m n][H3:impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) m n]pair%%(coimpliesRel%%(list A)%%(list A)%%B R R l n)%%(impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) l n) ([z:B][hypS:R n z]H z (H2 z hypS)) ([x:B][hypR:op%%(list A)%%B R x l]H3 x (H1 x hypR))))) ([l,m|list A]pair%%(coimpliesRel%%(list A)%%(list A)%%B R R (append%%A l m) (append%%A m l))%%(impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) (append%%A l m) (append%%A m l)) (swapR m l) (swapR l m)) ([a|A][m,n|list A][cons_prem:Perm%%A m n][cons_ih:kerR m n]cons_ih%%(kerR (cons%%A a m) (cons%%A a n)) ([H:coimpliesRel%%(list A)%%(list A)%%B R R m n][H1:impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) m n]pair%%(coimpliesRel%%(list A)%%(list A)%%B R R (cons%%A a m) (cons%%A a n))%%(impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R) (cons%%A a m) (cons%%A a n)) ([z:B][hypS:R (cons%%A a n) z]consclR a n m (symPerm%%A%%m%%n cons_prem) H z hypS) ([x:B][hypR:op%%(list A)%%B R x (cons%%A a m)]consclR a m n cons_prem H1 x hypR)))) (andRelE1%%(list A)%%(list A)%%(coimpliesRel%%(list A)%%(list A)%%B R R)%%(impliesRel%%B%%(list A)%%(list A) (op%%(list A)%%B R) (op%%(list A)%%B R))%%kerR (reflSubRel%%(list A)%%(list A) kerR))];
[PermPredE : {A|Type(0)}{P:Pred (list A)}{swapP:{l,m:list A}(P (append%%A l m))->P (append%%A m l)}{consclP:{b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:iff (P l) (P m)}(P (cons%%A b l))->P (cons%%A b m)}{l,m:list A}{perm_hyp:Perm%%A l m}(P l)->P m
  = [A|Type(0)][P:Pred (list A)][swapP:{l,m:list A}(P (append%%A l m))->P (append%%A m l)][consclP:{b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:iff (P l) (P m)}(P (cons%%A b l))->P (cons%%A b m)][l,m:list A][perm_hyp:Perm%%A l m][H:P l]PermE%%A ([l'9,m'10:list A]iff (P l'9) (P m'10)) ([l1,m1|list A][eq_prem:Eq%%(list A) l1 m1]pair%%((P l1)->P m1)%%((P m1)->P l1) ([H1:P l1]Eq_subst%%(list A)%%l1%%m1 (Eq_sym%%(list A)%%m1%%l1 (Eq_sym%%(list A)%%l1%%m1 eq_prem)) ([z:list A]P z) H1) ([H1:P m1]Eq_subst%%(list A)%%m1%%l1 (Eq_sym%%(list A)%%l1%%m1 eq_prem) ([z:list A]P z) H1)) ([l1,m1|list A][sym_prem:Perm%%A l1 m1][sym_ih:iff (P l1) (P m1)]sym_ih%%(iff (P m1) (P l1)) ([H1:(P l1)->P m1][H2:(P m1)->P l1]pair%%((P m1)->P l1)%%((P l1)->P m1) H2 H1)) ([l1,m1,n|list A][lt_prem:Perm%%A l1 m1][lt_ih:iff (P l1) (P m1)][rt_prem:Perm%%A m1 n][rt_ih:iff (P m1) (P n)]lt_ih%%(iff (P l1) (P n)) ([H1:(P l1)->P m1][H2:(P m1)->P l1]rt_ih%%(iff (P l1) (P n)) ([H3:(P m1)->P n][H4:(P n)->P m1]pair%%((P l1)->P n)%%((P n)->P l1) ([H5:P l1]H3 (H1 H5)) ([H5:P n]H2 (H4 H5))))) ([l1,m1|list A]pair%%((P (append%%A l1 m1))->P (append%%A m1 l1))%%((P (append%%A m1 l1))->P (append%%A l1 m1)) (swapP l1 m1) (swapP m1 l1)) ([a|A][m1,n|list A][cons_prem:Perm%%A m1 n][cons_ih:iff (P m1) (P n)]cons_ih%%(iff (P (cons%%A a m1)) (P (cons%%A a n))) ([H1:(P m1)->P n][H2:(P n)->P m1]pair%%((P (cons%%A a m1))->P (cons%%A a n))%%((P (cons%%A a n))->P (cons%%A a m1)) (consclP a m1 n cons_prem cons_ih) (consclP a n m1 (symPerm%%A%%m1%%n cons_prem) (pair%%((P n)->P m1)%%((P m1)->P n) H2 H1))))%%l%%m perm_hyp%%(P m) ([H1:(P l)->P m][H2:(P m)->P l]H1 H)];
[nilPermlemma : {A|Type(0)}{l,m|list A}{perm_hyp:Perm%%A l m}(Eq%%(list A) (nil A) l)->Eq%%(list A) (nil A) m
  = [A|Type(0)][l,m|list A][perm_hyp:Perm%%A l m][H:Eq%%(list A) (nil A) l]PermPredE%%A (Eq%%(list A) (nil A)) ([l1,m1:list A][H1:Eq%%(list A) (nil A) (append%%A l1 m1)]append_strict%%A l1 m1 (Eq_sym%%(list A)%%(nil A)%%(append%%A l1 m1) H1)%%(Eq%%(list A) (nil A) (append%%A m1 l1)) ([eql1nil:Eq%%(list A) l1 (nil A)][eqm1nil:Eq%%(list A) m1 (nil A)]Eq_subst%%(list A)%%(nil A)%%m1 (Eq_sym%%(list A)%%m1%%(nil A) eqm1nil) ([z:list A]Eq%%(list A) (nil A) (append%%A z l1)) (Eq_sym%%(list A)%%l1%%(nil A) eql1nil))) ([b:A][l1,m1:list A][cons_prem:Perm%%A l1 m1][cons_ih:iff (Eq%%(list A) (nil A) l1) (Eq%%(list A) (nil A) m1)][H1:Eq%%(list A) (nil A) (cons%%A b l1)]nil_not_cons%%A l1 b H1 (Eq%%(list A) (nil A) (cons%%A b m1))) l m perm_hyp H];
[nilPerm : {A|Type(0)}{l:list A}{perm_nil:Perm%%A (nil A) l}Eq%%(list A) (nil A) l
  = [A|Type(0)][l:list A][perm_nil:Perm%%A (nil A) l]nilPermlemma%%A%%(nil A)%%l perm_nil (Eq_refl%%(list A) (nil A))];
[singletonPermlemma : {A|Type(0)}{l,m:list A}{perm_hyp:Perm%%A l m}{a:A}(Eq%%(list A) (singleton%%A a) l)->Ex%%A ([b:A](Eq%%A a b /\ Eq%%(list A) (singleton%%A b) m))
  = [A|Type(0)][l,m:list A][perm_hyp:Perm%%A l m][a:A][H:Eq%%(list A) (singleton%%A a) l]ExIntro%%A a ([b:A](Eq%%A a b /\ Eq%%(list A) (singleton%%A b) m)) (pair%%(Eq%%A a a)%%(Eq%%(list A) (singleton%%A a) m) (Eq_refl%%A a) (PermRrespR%%A%%A ([a'7:A][l'8:list A]Eq%%(list A) (singleton%%A a'7) l'8) ([l1,m1:list A][h:A][H1:Eq%%(list A) (singleton%%A h) (append%%A l1 m1)]insertapp%%A%%h%%(nil A)%%(nil A) l1 m1 (Eq_trans%%(list A)%%(insert%%A h (nil A) (nil A))%%(singleton%%A h)%%(append%%A l1 m1) (Eq_refl%%(list A) (insert%%A h (nil A) (nil A))) H1)%%(Eq%%(list A) (singleton%%A h) (append%%A m1 l1)) ([H2:{phi:Prop}({n:list A}(Eq%%(list A) (insert%%A h (nil A) n) l1)->(Eq%%(list A) (append%%A n m1) (nil A))->phi)->phi]H2 (Eq%%(list A) (singleton%%A h) (append%%A m1 l1)) ([n:list A][H3:Eq%%(list A) (insert%%A h (nil A) n) l1][H4:Eq%%(list A) (append%%A n m1) (nil A)]append_strict%%A n m1 H4%%(Eq%%(list A) (singleton%%A h) (append%%A m1 l1)) ([neqnil:Eq%%(list A) n (nil A)][m1eqnil:Eq%%(list A) m1 (nil A)]Eq_subst%%(list A)%%(nil A)%%m1 (Eq_sym%%(list A)%%m1%%(nil A) m1eqnil) ([z:list A]Eq%%(list A) (singleton%%A h) (append%%A z l1)) (Eq_subst%%(list A)%%(insert%%A h (nil A) n)%%l1 (Eq_sym%%(list A)%%l1%%(insert%%A h (nil A) n) (Eq_sym%%(list A)%%(insert%%A h (nil A) n)%%l1 H3)) ([z:list A]Eq%%(list A) (singleton%%A h) z) (Eq_subst%%(list A)%%(nil A)%%n (Eq_sym%%(list A)%%n%%(nil A) neqnil) ([z:list A]Eq%%(list A) (singleton%%A h) (insert%%A h (nil A) z)) (Eq_refl%%(list A) (singleton%%A h))))))) ([H2:{phi:Prop}({n:list A}(Eq%%(list A) (append%%A l1 n) (nil A))->(Eq%%(list A) (insert%%A h n (nil A)) m1)->phi)->phi]H2 (Eq%%(list A) (singleton%%A h) (append%%A m1 l1)) ([n:list A][H3:Eq%%(list A) (append%%A l1 n) (nil A)][H4:Eq%%(list A) (insert%%A h n (nil A)) m1]append_strict%%A l1 n H3%%(Eq%%(list A) (singleton%%A h) (append%%A m1 l1)) ([l1eqnil:Eq%%(list A) l1 (nil A)][neqnil:Eq%%(list A) n (nil A)]Eq_subst%%(list A)%%(nil A)%%l1 (Eq_sym%%(list A)%%l1%%(nil A) l1eqnil) ([z:list A]Eq%%(list A) (singleton%%A h) (append%%A m1 z)) (Eq_subst%%(list A)%%(insert%%A h n (nil A))%%m1 (Eq_sym%%(list A)%%m1%%(insert%%A h n (nil A)) (Eq_sym%%(list A)%%(insert%%A h n (nil A))%%m1 H4)) ([z:list A]Eq%%(list A) (singleton%%A h) (append%%A z (nil A))) (Eq_subst%%(list A)%%(nil A)%%n (Eq_sym%%(list A)%%n%%(nil A) neqnil) ([z:list A]Eq%%(list A) (singleton%%A h) (append%%A (insert%%A h z (nil A)) (nil A))) (Eq_refl%%(list A) (singleton%%A h)))))))) ([b:A][l1,m1:list A][cons_prem:Perm%%A l1 m1][cons_ih:{h:A}(Eq%%(list A) (singleton%%A h) l1)->Eq%%(list A) (singleton%%A h) m1][k:A][H1:Eq%%(list A) (singleton%%A k) (cons%%A b l1)]cons_inj%%A%%k%%b%%(nil A)%%l1 H1%%(Eq%%(list A) (singleton%%A k) (cons%%A b m1)) ([keqb:Eq%%A k b][nileql1:Eq%%(list A) (nil A) l1]Eq_subst%%A%%b%%k (Eq_sym%%A%%k%%b keqb) ([z:A]Eq%%(list A) (singleton%%A z) (cons%%A b m1)) (Eq_resp%%(list A)%%(list A) (cons%%A b)%%(nil A)%%m1 (nilPerm%%A m1 (transPerm%%A%%(nil A)%%l1%%m1 (reflPerm'%%A%%(nil A)%%l1 nileql1) cons_prem)))))%%l%%m perm_hyp a H))];
[singletonPerm : {A|Type(0)}{a,b:A}(Perm%%A (singleton%%A a) (singleton%%A b))->Eq%%A a b
  = [A|Type(0)][a,b:A][H:Perm%%A (singleton%%A a) (singleton%%A b)]singletonPermlemma%%A (singleton%%A a) (singleton%%A b) H a (Eq_refl%%(list A) (singleton%%A a)) (Eq%%A a b) ([t:A][H1:Eq%%A a t /\ Eq%%(list A) (singleton%%A t) (singleton%%A b)]H1%%(Eq%%A a b) ([H2:Eq%%A a t][H3:Eq%%(list A) (singleton%%A t) (singleton%%A b)]Eq_trans%%A%%a%%t%%b H2 (cons_inj%%A%%t%%b%%(nil A)%%(nil A) H3%%(Eq|A t b) ([H4:Eq%%A t b][H5:Eq%%(list A) (nil A) (nil A)]H4))))];
[PermRespLength : {A|Type(0)}{l,m|list A}{Perm_hyp:Perm%%A l m}Eq%%nat (length%%A l) (length%%A m)
  = [A|Type(0)]PermE%%A ([l,m:list A]Eq%%nat (length%%A l) (length%%A m)) ([l,m|list A][eq_prem:Eq%%(list A) l m]Eq_resp%%(list A)%%nat (length%%A)%%l%%m eq_prem) ([l,m|list A][sym_prem:Perm%%A l m][sym_ih:Eq%%nat (length%%A l) (length%%A m)]Eq_sym%%nat%%(length%%A l)%%(length%%A m) sym_ih) ([l,m,n|list A][lt_prem:Perm%%A l m][lt_ih:Eq%%nat (length%%A l) (length%%A m)][rt_prem:Perm%%A m n][rt_ih:Eq%%nat (length%%A m) (length%%A n)]Eq_trans%%nat%%(length%%A l)%%(length%%A m)%%(length%%A n) lt_ih rt_ih) ([l,m|list A]Eq_trans%%nat%%(length%%A (append%%A l m))%%(plus (length%%A l) (length%%A m))%%(length%%A (append%%A m l)) (length_append%%A l m) (Eq_trans%%nat%%(plus (length%%A l) (length%%A m))%%(plus (length%%A m) (length%%A l))%%(length%%A (append%%A m l)) (plus_commutes (length%%A l) (length%%A m)) (Eq_sym%%nat%%(length%%A (append%%A m l))%%(plus (length%%A m) (length%%A l)) (length_append%%A m l)))) ([a|A][m,n|list A][cons_prem:Perm%%A m n][cons_ih:Eq%%nat (length%%A m) (length%%A n)]Eq_resp%%nat%%nat suc%%(list_elim%%A ([_:list A]nat) zero ([y:A][_:list A]([_:A]suc) y) m)%%(list_elim%%A ([_:list A]nat) zero ([y:A][_:list A]([_:A]suc) y) n) cons_ih)];
[PermResidue : {A|Type(0)}{a:A}Rel (list A) (list A)
  = [A|Type(0)][a:A][l,m:list A]{phi:Prop}{ex_hk:{h,k:list A}{perm_lhk:Perm%%A l (append%%A h k)}{ins_hkm:Eq%%(list A) (insert%%A a h k) m}phi}phi];
[insResidue : {A|Type(0)}{a:A}{h,k,l:list A}{ins_hkl:Eq%%(list A) (insert%%A a h k) l}PermResidue%%A a (append%%A h k) l
  = [A|Type(0)][a:A][h,k,l:list A][ins_hkl:Eq%%(list A) (insert%%A a h k) l][phi:Prop][ex_hk:{h'8,k'9:list A}{perm_lhk:Perm%%A (append%%A h k) (append%%A h'8 k'9)}{ins_hkm:Eq%%(list A) (insert%%A a h'8 k'9) l}phi]ex_hk h k (reflPerm%%A (append%%A h k)) ins_hkl];
[swapResidue : {A|Type(0)}{a:A}{l,m,n:list A}{res_nlm:PermResidue%%A a n (append%%A l m)}PermResidue%%A a n (append%%A m l)
  = [A|Type(0)][a:A][l,m,n:list A][res_nlm:PermResidue%%A a n (append%%A l m)]res_nlm (PermResidue%%A a n (append%%A m l)) ([h,k:list A][perm_lhk:Perm%%A n (append%%A h k)][ins_hkm:Eq%%(list A) (insert%%A a h k) (append%%A l m)]insertapp%%A%%a%%h%%k l m ins_hkm%%(PermResidue%%A a n (append%%A m l)) ([H:{phi:Prop}({n'12:list A}(Eq%%(list A) (insert%%A a h n'12) l)->(Eq%%(list A) (append%%A n'12 m) k)->phi)->phi]H (PermResidue%%A a n (append%%A m l)) ([n1:list A][H1:Eq%%(list A) (insert%%A a h n1) l][H2:Eq%%(list A) (append%%A n1 m) k][phi:Prop][ex_hk:{h'16,k'17:list A}{perm_lhk'18:Perm%%A n (append%%A h'16 k'17)}{ins_hkm'19:Eq%%(list A) (insert%%A a h'16 k'17) (append%%A m l)}phi]ex_hk (append%%A m h) n1 (transPerm%%A%%n%%(append%%A h k)%%(append%%A (append%%A m h) n1) perm_lhk (Eq_subst%%(list A)%%(append%%A n1 m)%%k (Eq_sym%%(list A)%%k%%(append%%A n1 m) (Eq_sym%%(list A)%%(append%%A n1 m)%%k H2)) ([z:list A]Perm%%A (append%%A h z) (append%%A (append%%A m h) n1)) (Eq_subst%%(list A)%%(append%%A (append%%A h n1) m)%%(append%%A h (append%%A n1 m)) (Eq_sym%%(list A)%%(append%%A h (append%%A n1 m))%%(append%%A (append%%A h n1) m) (append_assoc%%A h n1 m)) ([z:list A]Perm%%A z (append%%A (append%%A m h) n1)) (symPerm%%A%%(append%%A (append%%A m h) n1)%%(append%%A (append%%A h n1) m) (Eq_subst%%(list A)%%(append%%A m (append%%A h n1))%%(append%%A (append%%A m h) n1) (Eq_sym%%(list A)%%(append%%A (append%%A m h) n1)%%(append%%A m (append%%A h n1)) (Eq_sym%%(list A)%%(append%%A m (append%%A h n1))%%(append%%A (append%%A m h) n1) (append_assoc%%A m h n1))) ([z:list A]Perm%%A z (append%%A (append%%A h n1) m)) (swapPerm%%A m (append%%A h n1))))))) (Eq_subst%%(list A)%%(insert%%A a h n1)%%l (Eq_sym%%(list A)%%l%%(insert%%A a h n1) (Eq_sym%%(list A)%%(insert%%A a h n1)%%l H1)) ([z:list A]Eq%%(list A) (insert%%A a (append%%A m h) n1) (append%%A m z)) (Eq_sym%%(list A)%%(append%%A m (insert%%A a h n1))%%(insert%%A a (append%%A m h) n1) (append_assoc%%A m h (cons%%A a n1)))))) ([H:{phi:Prop}({n'12:list A}(Eq%%(list A) (append%%A l n'12) h)->(Eq%%(list A) (insert%%A a n'12 k) m)->phi)->phi]H (PermResidue%%A a n (append%%A m l)) ([n1:list A][H1:Eq%%(list A) (append%%A l n1) h][H2:Eq%%(list A) (insert%%A a n1 k) m][phi:Prop][ex_hk:{h'16,k'17:list A}{perm_lhk'18:Perm%%A n (append%%A h'16 k'17)}{ins_hkm'19:Eq%%(list A) (insert%%A a h'16 k'17) (append%%A m l)}phi]ex_hk n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k) (transPerm%%A%%n%%(append%%A h k)%%(append%%A n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k)) perm_lhk (Eq_subst%%(list A)%%(append%%A l n1)%%h (Eq_sym%%(list A)%%h%%(append%%A l n1) (Eq_sym%%(list A)%%(append%%A l n1)%%h H1)) ([z:list A]Perm%%A (append%%A z k) (append%%A n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k))) (Eq_subst%%(list A)%%(append%%A l (append%%A n1 k))%%(append%%A (append%%A l n1) k) (Eq_sym%%(list A)%%(append%%A (append%%A l n1) k)%%(append%%A l (append%%A n1 k)) (Eq_sym%%(list A)%%(append%%A l (append%%A n1 k))%%(append%%A (append%%A l n1) k) (append_assoc%%A l n1 k))) ([z:list A]Perm%%A z (append%%A n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k))) (symPerm%%A%%(append%%A n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k))%%(append%%A l (append%%A n1 k)) (Eq_subst%%(list A)%%(append%%A (append%%A n1 k) l)%%(append%%A n1 (append%%A k l)) (Eq_sym%%(list A)%%(append%%A n1 (append%%A k l))%%(append%%A (append%%A n1 k) l) (append_assoc%%A n1 k l)) ([z:list A]Perm%%A z (append%%A l (append%%A n1 k))) (swapPerm%%A (append%%A n1 k) l)))))) (Eq_subst%%(list A)%%(insert%%A a n1 k)%%m (Eq_sym%%(list A)%%m%%(insert%%A a n1 k) (Eq_sym%%(list A)%%(insert%%A a n1 k)%%m H2)) ([z:list A]Eq%%(list A) (insert%%A a n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k)) (append%%A z l)) (Eq_trans%%(list A)%%(insert%%A a n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k))%%(append%%A n1 (append%%A (cons%%A a k) l))%%(append%%A (insert%%A a n1 k) l) (Eq_refl%%(list A) (insert%%A a n1 (list_elim%%A ([_:list A]list A) l ([y:A][_:list A]cons|A y) k))) (append_assoc%%A n1 (cons%%A a k) l))))))];
[consclResidue : {A|Type(0)}{a,b:A}{l,m:list A}{cons_prem:Perm%%A l m}{cons_ih:{h:list A}{res_hl:PermResidue%%A a h l}PermResidue%%A a h m}{k:list A}{res_kbl:PermResidue%%A a k (cons%%A b l)}PermResidue%%A a k (cons%%A b m)
  = [A|Type(0)][a,b:A][l,m:list A][cons_prem:Perm%%A l m][cons_ih:{h:list A}{res_hl:PermResidue%%A a h l}PermResidue%%A a h m][k:list A][res_kbl:PermResidue%%A a k (cons%%A b l)]res_kbl (PermResidue%%A a k (cons%%A b m)) ([h,k1:list A][perm_lhk:Perm%%A k (append%%A h k1)][ins_hkm:Eq%%(list A) (insert%%A a h k1) (cons%%A b l)]insertapp%%A%%a%%h%%k1 (cons%%A b (nil A)) l ins_hkm%%(PermResidue%%A a k (cons%%A b m)) ([H:{phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h n) (cons%%A b (nil A)))->(Eq%%(list A) (append%%A n l) k1)->phi)->phi]H (PermResidue%%A a k (cons%%A b m)) ([n:list A][H1:Eq%%(list A) (insert%%A a h n) (cons%%A b (nil A))][H2:Eq%%(list A) (append%%A n l) k1]insertsingleton%%A%%a%%b%%h%%n H1%%(PermResidue%%A a k (cons%%A b m)) ([nileqh:Eq%%(list A) (nil A) h][aeqb:Eq%%A a b][nileqn:Eq%%(list A) (nil A) n][phi:Prop][ex_hk:{h'22,k'23:list A}{perm_lhk'24:Perm%%A k (append%%A h'22 k'23)}{ins_hkm'25:Eq%%(list A) (insert%%A a h'22 k'23) (cons%%A b m)}phi]ex_hk (nil A) m (transPerm%%A%%k%%(append%%A h k1)%%(append%%A (nil A) m) perm_lhk (Eq_subst%%(list A)%%(append%%A n l)%%k1 (Eq_sym%%(list A)%%k1%%(append%%A n l) (Eq_sym%%(list A)%%(append%%A n l)%%k1 H2)) ([z:list A]Perm%%A (append%%A h z) (append%%A (nil A) m)) (Eq_subst%%(list A)%%(nil A)%%h (Eq_sym%%(list A)%%h%%(nil A) (Eq_sym%%(list A)%%(nil A)%%h nileqh)) ([z:list A]Perm%%A (append%%A z (append%%A n l)) (append%%A (nil A) m)) (Eq_subst%%(list A)%%(nil A)%%n (Eq_sym%%(list A)%%n%%(nil A) (Eq_sym%%(list A)%%(nil A)%%n nileqn)) ([z:list A]Perm%%A (append%%A (nil A) (append%%A z l)) (append%%A (nil A) m)) cons_prem)))) (Eq_subst%%A%%a%%b (Eq_sym%%A%%b%%a (Eq_sym%%A%%a%%b aeqb)) ([z:A]Eq%%(list A) (insert%%A a (nil A) m) (cons%%A z m)) (Eq_refl%%(list A) (insert%%A a (nil A) m)))))) ([H:{phi:Prop}({n:list A}(Eq%%(list A) (append%%A (cons%%A b (nil A)) n) h)->(Eq%%(list A) (insert%%A a n k1) l)->phi)->phi]H (PermResidue%%A a k (cons%%A b m)) ([n:list A][H1:Eq%%(list A) (append%%A (cons%%A b (nil A)) n) h][H2:Eq%%(list A) (insert%%A a n k1) l]cons_ih (append%%A n k1) (insResidue%%A a n k1 l H2) (PermResidue%%A a k (cons%%A b m)) ([h1,k2:list A][perm_lhk1:Perm%%A (append%%A n k1) (append%%A h1 k2)][ins_hkm1:Eq%%(list A) (insert%%A a h1 k2) m][phi:Prop][ex_hk:{h'23,k'24:list A}{perm_lhk'25:Perm%%A k (append%%A h'23 k'24)}{ins_hkm'26:Eq%%(list A) (insert%%A a h'23 k'24) (cons%%A b m)}phi]ex_hk (cons%%A b h1) k2 (transPerm%%A%%k%%(append%%A h k1)%%(append%%A (cons%%A b h1) k2) perm_lhk (Eq_subst%%(list A)%%(append%%A (cons%%A b (nil A)) n)%%h (Eq_sym%%(list A)%%h%%(append%%A (cons%%A b (nil A)) n) (Eq_sym%%(list A)%%(append%%A (cons%%A b (nil A)) n)%%h H1)) ([z:list A]Perm%%A (append%%A z k1) (append%%A (cons%%A b h1) k2)) (consclPerm%%A b%%(list_elim%%A ([_:list A]list A) k1 ([y:A][_:list A]cons|A y) (list_elim%%A ([_:list A]list A) n ([y:A][_:list A]cons|A y) (nil A)))%%(list_elim%%A ([_:list A]list A) k2 ([y:A][_:list A]cons|A y) h1) perm_lhk1))) (Eq_subst%%(list A)%%(insert%%A a h1 k2)%%m (Eq_sym%%(list A)%%m%%(insert%%A a h1 k2) (Eq_sym%%(list A)%%(insert%%A a h1 k2)%%m ins_hkm1)) ([z:list A]Eq%%(list A) (insert%%A a (cons%%A b h1) k2) (cons%%A b z)) (Eq_refl%%(list A) (insert%%A a (cons%%A b h1) k2)))))))];
[funopResidue : {A|Type(0)}{a:A}{h,k,l:list A}{res_hl:PermResidue%%A a h l}{res_kl:PermResidue%%A a k l}Perm%%A h k
  = [A|Type(0)][a:A][h,k,l:list A][res_hl:PermResidue%%A a h l][res_kl:PermResidue%%A a k l]res_hl (Perm%%A h k) ([h1,k1:list A][perm_lhk:Perm%%A h (append%%A h1 k1)][ins_hkm:Eq%%(list A) (insert%%A a h1 k1) l]res_kl (Perm%%A h k) ([h2,k2:list A][perm_lhk1:Perm%%A k (append%%A h2 k2)][ins_hkm1:Eq%%(list A) (insert%%A a h2 k2) l]inseqins%%A%%a%%h1%%k1%%h2%%k2 (Eq_trans%%(list A)%%(insert%%A a h1 k1)%%l%%(insert%%A a h2 k2) ins_hkm (Eq_sym%%(list A)%%(insert%%A a h2 k2)%%l ins_hkm1))%%(Perm%%A h k) ([H:{phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h1 n) h2)->(Eq%%(list A) (insert%%A a n k2) k1)->phi)->phi]H (Perm%%A h k) ([n:list A][H1:Eq%%(list A) (insert%%A a h1 n) h2][H2:Eq%%(list A) (insert%%A a n k2) k1]transPerm%%A%%h%%(append%%A h1 k1)%%k perm_lhk (Eq_subst%%(list A)%%(insert%%A a n k2)%%k1 (Eq_sym%%(list A)%%k1%%(insert%%A a n k2) (Eq_sym%%(list A)%%(insert%%A a n k2)%%k1 H2)) ([z:list A]Perm%%A (append%%A h1 z) k) (symPerm%%A%%k%%(append%%A h1 (insert%%A a n k2)) (transPerm%%A%%k%%(append%%A h2 k2)%%(append%%A h1 (insert%%A a n k2)) perm_lhk1 (Eq_subst%%(list A)%%(insert%%A a h1 n)%%h2 (Eq_sym%%(list A)%%h2%%(insert%%A a h1 n) (Eq_sym%%(list A)%%(insert%%A a h1 n)%%h2 H1)) ([z:list A]Perm%%A (append%%A z k2) (append%%A h1 (insert%%A a n k2))) (transPerm%%A%%(append%%A (insert%%A a h1 n) k2)%%(append%%A (cons%%A a k2) (append%%A h1 n))%%(append%%A h1 (insert%%A a n k2)) (transPerm%%A%%(append%%A (insert%%A a h1 n) k2)%%(append%%A (append%%A (cons%%A a n) k2) h1)%%(append%%A (cons%%A a k2) (append%%A h1 n)) (symPerm%%A%%(append%%A (append%%A (cons%%A a n) k2) h1)%%(append%%A (insert%%A a h1 n) k2) (Eq_subst%%(list A)%%(append%%A h1 (append%%A (cons%%A a n) k2))%%(append%%A (append%%A h1 (cons%%A a n)) k2) (Eq_sym%%(list A)%%(append%%A (append%%A h1 (cons%%A a n)) k2)%%(append%%A h1 (append%%A (cons%%A a n) k2)) (Eq_sym%%(list A)%%(append%%A h1 (append%%A (cons%%A a n) k2))%%(append%%A (append%%A h1 (cons%%A a n)) k2) (append_assoc%%A h1 (cons%%A a n) k2))) ([z:list A]Perm%%A (append%%A (append%%A (cons%%A a n) k2) h1) z) (swapPerm%%A (append%%A (cons%%A a n) k2) h1))) (consclPerm%%A a%%(list_elim%%A ([_:list A]list A) h1 ([y:A][_:list A]cons|A y) (list_elim%%A ([_:list A]list A) k2 ([y:A][_:list A]cons|A y) n))%%(list_elim%%A ([_:list A]list A) (append%%A h1 n) ([y:A][_:list A]cons|A y) k2) (transPerm%%A%%(list_elim%%A ([_:list A]list A) h1 ([y:A][_:list A]cons|A y) (list_elim%%A ([_:list A]list A) k2 ([y:A][_:list A]cons|A y) n))%%(append%%A (append%%A h1 n) k2)%%(list_elim%%A ([_:list A]list A) (append%%A h1 n) ([y:A][_:list A]cons|A y) k2) (Eq_subst%%(list A)%%(append%%A h1 (append%%A n k2))%%(append%%A (append%%A h1 n) k2) (Eq_sym%%(list A)%%(append%%A (append%%A h1 n) k2)%%(append%%A h1 (append%%A n k2)) (Eq_sym%%(list A)%%(append%%A h1 (append%%A n k2))%%(append%%A (append%%A h1 n) k2) (append_assoc%%A h1 n k2))) ([z:list A]Perm%%A (list_elim%%A ([_:list A]list A) h1 ([y:A][_:list A]cons|A y) (list_elim%%A ([_:list A]list A) k2 ([y:A][_:list A]cons|A y) n)) z) (swapPerm%%A (list_elim%%A ([_:list A]list A) k2 ([y:A][_:list A]cons|A y) n) h1)) (swapPerm%%A (append%%A h1 n) k2)))) (Eq_subst%%(list A)%%(append%%A (append%%A h1 n) (cons%%A a k2))%%(append%%A h1 (append%%A n (cons%%A a k2))) (Eq_sym%%(list A)%%(append%%A h1 (append%%A n (cons%%A a k2)))%%(append%%A (append%%A h1 n) (cons%%A a k2)) (append_assoc%%A h1 n (cons%%A a k2))) ([z:list A]Perm%%A (append%%A (cons%%A a k2) (append%%A h1 n)) z) (swapPerm%%A (cons%%A a k2) (append%%A h1 n)))))))))) ([H:(Eq%%(list A) h2 h1 /\ Eq%%(list A) k1 k2) \/ {phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h2 n) h1)->(Eq%%(list A) (insert%%A a n k1) k2)->phi)->phi]H%%(Perm%%A h k) ([H1:Eq%%(list A) h2 h1 /\ Eq%%(list A) k1 k2]H1%%(Perm%%A h k) ([h2eqh1:Eq%%(list A) h2 h1][k1eqk2:Eq%%(list A) k1 k2]transPerm%%A%%h%%(append%%A h1 k1)%%k perm_lhk (Eq_subst%%(list A)%%h2%%h1 (Eq_sym%%(list A)%%h1%%h2 (Eq_sym%%(list A)%%h2%%h1 h2eqh1)) ([z:list A]Perm%%A (append%%A z k1) k) (symPerm%%A%%k%%(append%%A h2 k1) (transPerm%%A%%k%%(append%%A h2 k2)%%(append%%A h2 k1) perm_lhk1 (Eq_subst%%(list A)%%k1%%k2 (Eq_sym%%(list A)%%k2%%k1 (Eq_sym%%(list A)%%k1%%k2 k1eqk2)) ([z:list A]Perm%%A (append%%A h2 z) (append%%A h2 k1)) (reflPerm%%A (append%%A h2 k1)))))))) ([H1:{phi:Prop}({n:list A}(Eq%%(list A) (insert%%A a h2 n) h1)->(Eq%%(list A) (insert%%A a n k1) k2)->phi)->phi]H1 (Perm%%A h k) ([n:list A][H2:Eq%%(list A) (insert%%A a h2 n) h1][H3:Eq%%(list A) (insert%%A a n k1) k2]transPerm%%A%%h%%(append%%A h1 k1)%%k perm_lhk (Eq_subst%%(list A)%%(insert%%A a h2 n)%%h1 (Eq_sym%%(list A)%%h1%%(insert%%A a h2 n) (Eq_sym%%(list A)%%(insert%%A a h2 n)%%h1 H2)) ([z:list A]Perm%%A (append%%A z k1) k) (symPerm%%A%%k%%(append%%A (insert%%A a h2 n) k1) (transPerm%%A%%k%%(append%%A h2 k2)%%(append%%A (insert%%A a h2 n) k1) perm_lhk1 (Eq_subst%%(list A)%%(insert%%A a n k1)%%k2 (Eq_sym%%(list A)%%k2%%(insert%%A a n k1) (Eq_sym%%(list A)%%(insert%%A a n k1)%%k2 H3)) ([z:list A]Perm%%A (append%%A h2 z) (append%%A (insert%%A a h2 n) k1)) (transPerm%%A%%(append%%A h2 (insert%%A a n k1))%%(append%%A (append%%A (cons%%A a n) k1) h2)%%(append%%A (insert%%A a h2 n) k1) (transPerm%%A%%(append%%A h2 (insert%%A a n k1))%%(append%%A (cons%%A a k1) (append%%A h2 n))%%(append%%A (append%%A (cons%%A a n) k1) h2) (symPerm%%A%%(append%%A (cons%%A a k1) (append%%A h2 n))%%(append%%A h2 (insert%%A a n k1)) (Eq_subst%%(list A)%%(append%%A (append%%A h2 n) (cons%%A a k1))%%(append%%A h2 (append%%A n (cons%%A a k1))) (Eq_sym%%(list A)%%(append%%A h2 (append%%A n (cons%%A a k1)))%%(append%%A (append%%A h2 n) (cons%%A a k1)) (append_assoc%%A h2 n (cons%%A a k1))) ([z:list A]Perm%%A (append%%A (cons%%A a k1) (append%%A h2 n)) z) (swapPerm%%A (cons%%A a k1) (append%%A h2 n)))) (consclPerm%%A a%%(list_elim%%A ([_:list A]list A) (append%%A h2 n) ([y:A][_:list A]cons|A y) k1)%%(list_elim%%A ([_:list A]list A) h2 ([y:A][_:list A]cons|A y) (list_elim%%A ([_:list A]list A) k1 ([y:A][_:list A]cons|A y) n)) (transPerm%%A%%(list_elim%%A ([_:list A]list A) (append%%A h2 n) ([y:A][_:list A]cons|A y) k1)%%(append%%A (append%%A k1 h2) n)%%(list_elim%%A ([_:list A]list A) h2 ([y:A][_:list A]cons|A y) (list_elim%%A ([_:list A]list A) k1 ([y:A][_:list A]cons|A y) n)) (Eq_subst%%(list A)%%(append%%A k1 (append%%A h2 n))%%(append%%A (append%%A k1 h2) n) (Eq_sym%%(list A)%%(append%%A (append%%A k1 h2) n)%%(append%%A k1 (append%%A h2 n)) (Eq_sym%%(list A)%%(append%%A k1 (append%%A h2 n))%%(append%%A (append%%A k1 h2) n) (append_assoc%%A k1 h2 n))) ([z:list A]Perm%%A (list_elim%%A ([_:list A]list A) (append%%A h2 n) ([y:A][_:list A]cons|A y) k1) z) (reflPerm%%A (list_elim%%A ([_:list A]list A) (append%%A h2 n) ([y:A][_:list A]cons|A y) k1))) (Eq_subst%%(list A)%%(append%%A n (append%%A k1 h2))%%(append%%A (append%%A n k1) h2) (Eq_sym%%(list A)%%(append%%A (append%%A n k1) h2)%%(append%%A n (append%%A k1 h2)) (Eq_sym%%(list A)%%(append%%A n (append%%A k1 h2))%%(append%%A (append%%A n k1) h2) (append_assoc%%A n k1 h2))) ([z:list A]Perm%%A (append%%A (append%%A k1 h2) n) z) (swapPerm%%A (append%%A k1 h2) n))))) (Eq_subst%%(list A)%%(append%%A h2 (append%%A (cons%%A a n) k1))%%(append%%A (append%%A h2 (cons%%A a n)) k1) (Eq_sym%%(list A)%%(append%%A (append%%A h2 (cons%%A a n)) k1)%%(append%%A h2 (append%%A (cons%%A a n) k1)) (Eq_sym%%(list A)%%(append%%A h2 (append%%A (cons%%A a n) k1))%%(append%%A (append%%A h2 (cons%%A a n)) k1) (append_assoc%%A h2 (cons%%A a n) k1))) ([z:list A]Perm%%A (append%%A (append%%A (cons%%A a n) k1) h2) z) (swapPerm%%A (append%%A (cons%%A a n) k1) h2))))))))))))];
[transResiduelemma : {A|Type(0)}{a:A}{l,m,h|list A}{perm_hyp:Perm%%A l m}{eq_ahl:Eq%%(list A) (cons%%A a h) l}PermResidue%%A a h m
  = [A|Type(0)][a:A][l,m,h|list A][perm_hyp:Perm%%A l m][eq_ahl:Eq%%(list A) (cons%%A a h) l]PermRrespR%%A%%(list A) (PermResidue%%A a) ([l1,m1,h1:list A][H:PermResidue%%A a h1 (append%%A l1 m1)]swapResidue%%A a l1 m1 h1 H) ([b:A][l1,m1:list A][cons_prem:Perm%%A l1 m1][cons_ih:{h'12:list A}(PermResidue%%A a h'12 l1)->PermResidue%%A a h'12 m1][k:list A][H:PermResidue%%A a k (cons%%A b l1)]consclResidue%%A a b l1 m1 cons_prem cons_ih k H)%%l%%m perm_hyp h (insResidue%%A a (nil A) h l eq_ahl)];
[heredPermlemma : {A|Type(0)}{a:A}{l,m|list A}(Perm%%A (cons%%A a l) (cons%%A a m))->Perm%%A l m
  = [A|Type(0)][a:A][l,m|list A][H:Perm%%A (cons%%A a l) (cons%%A a m)][forallPerm=[l'6,m'7:list A]{h,k:list A}{eq1:Eq%%(list A) (cons%%A a h) l'6}{eq2:Eq%%(list A) (cons%%A a k) m'7}Perm%%A h k]PermE%%A forallPerm ([l1,m1|list A][eq_prem:Eq%%(list A) l1 m1][h,k:list A][eq1:Eq%%(list A) (cons%%A a h) l1][eq2:Eq%%(list A) (cons%%A a k) m1]reflPerm'%%A%%h%%k (snd%%(Eq%%A a a)%%(Eq%%(list A) h k) (cons_inj%%A%%a%%a%%h%%k (Eq_trans%%(list A)%%(cons%%A a h)%%l1%%(cons%%A a k) eq1 (Eq_subst%%(list A)%%m1%%l1 (Eq_sym%%(list A)%%l1%%m1 eq_prem) ([z:list A]Eq|(list A) z (cons%%A a k)) (Eq_sym%%(list A)%%(cons%%A a k)%%m1 eq2)))))) ([l1,m1|list A][sym_prem:Perm%%A l1 m1][sym_ih:forallPerm l1 m1][h,k:list A][eq1:Eq%%(list A) (cons%%A a h) m1][eq2:Eq%%(list A) (cons%%A a k) l1]symPerm%%A%%k%%h (sym_ih k h eq2 eq1)) ([l1,m1,n|list A][lt_prem:Perm%%A l1 m1][lt_ih:forallPerm l1 m1][rt_prem:Perm%%A m1 n][rt_ih:forallPerm m1 n][h,k:list A][eq1:Eq%%(list A) (cons%%A a h) l1][eq2:Eq%%(list A) (cons%%A a k) n]funopResidue%%A a h k m1 (transResiduelemma%%A a%%l1%%m1%%h lt_prem eq1) (transResiduelemma%%A a%%n%%m1%%k (symPerm%%A%%m1%%n rt_prem) eq2)) (list_elim%%A ([l'7:list A]{m'8:list A}forallPerm (append%%A l'7 m'8) (append%%A m'8 l'7)) ([m1,h,k:list A][eq1:Eq%%(list A) (cons%%A a h) (append%%A (nil A) m1)][eq2:Eq%%(list A) (cons%%A a k) (append%%A m1 (nil A))]reflPerm'%%A%%h%%k (snd%%(Eq%%A a a)%%(Eq%%(list A) h k) (cons_inj%%A%%a%%a%%h%%k (Eq_trans%%(list A)%%(cons%%A a h)%%(append%%A (nil A) m1)%%(cons%%A a k) eq1 (Eq_trans%%(list A)%%(append%%A (nil A) m1)%%(append%%A (append%%A (nil A) m1) (nil A))%%(cons%%A a k) (Eq_sym%%(list A)%%(append%%A (append%%A (nil A) m1) (nil A))%%(append%%A (nil A) m1) (append_nil%%A (append%%A (nil A) m1))) (Eq_sym%%(list A)%%(cons%%A a k)%%(append%%A (append%%A (nil A) m1) (nil A)) eq2)))))) ([x1:A][x2:list A][x2_ih:{m'9:list A}forallPerm (append%%A x2 m'9) (append%%A m'9 x2)][m1:list A]list_elim%%A ([m'11:list A]forallPerm (append%%A (cons%%A x1 x2) m'11) (append%%A m'11 (cons%%A x1 x2))) ([h,n:list A][eq1:Eq%%(list A) (cons%%A a h) (append%%A (cons%%A x1 x2) (nil A))][eq2:Eq%%(list A) (cons%%A a n) (append%%A (nil A) (cons%%A x1 x2))]cons_inj%%A%%a%%x1%%h%%(list_elim%%A ([_:list A]list A) (nil A) ([y:A][_:list A]cons|A y) x2) eq1%%(Perm%%A h n) ([H1:Eq%%A a x1][H2:Eq%%(list A) h (list_elim%%A ([_:list A]list A) (nil A) ([y:A][_:list A]cons|A y) x2)]cons_inj%%A%%a%%x1%%n%%x2 eq2%%(Perm%%A h n) ([H3:Eq%%A a x1][H4:Eq%%(list A) n x2]Eq_subst%%(list A)%%(list_elim%%A ([_:list A]list A) (nil A) ([y:A][_:list A]cons|A y) x2)%%h (Eq_sym%%(list A)%%h%%(list_elim%%A ([_:list A]list A) (nil A) ([y:A][_:list A]cons|A y) x2) H2) ([z:list A]Perm%%A z n) (Eq_subst%%(list A)%%x2%%n (Eq_sym%%(list A)%%n%%x2 H4) ([z:list A]Perm%%A (list_elim%%A ([_:list A]list A) (nil A) ([y:A][_:list A]cons|A y) x2) z) (Eq_subst%%(list A)%%x2%%(append%%A x2 (nil A)) (Eq_sym%%(list A)%%(append%%A x2 (nil A))%%x2 (append_nil%%A x2)) ([z:list A]Perm%%A z x2) (reflPerm%%A x2)))))) ([c:A][n:list A][x2_ih1:forallPerm (append%%A (cons%%A x1 x2) n) (append%%A n (cons%%A x1 x2))][h,j:list A][eq1:Eq%%(list A) (cons%%A a h) (append%%A (cons%%A x1 x2) (cons%%A c n))][eq2:Eq%%(list A) (cons%%A a j) (append%%A (cons%%A c n) (cons%%A x1 x2))]cons_inj%%A%%a%%x1%%h%%(list_elim%%A ([_:list A]list A) (cons%%A c n) ([y:A][_:list A]cons|A y) x2) eq1%%(Perm%%A h j) (cons_inj%%A%%a%%c%%j%%(list_elim%%A ([_:list A]list A) (cons%%A x1 x2) ([y:A][_:list A]cons|A y) n) eq2%%((Eq%%A a x1)->(Eq%%(list A) h (list_elim%%A ([_:list A]list A) (cons%%A c n) ([y:A][_:list A]cons|A y) x2))->Perm%%A h j) ([H1:Eq%%A a c][H2:Eq%%(list A) j (list_elim%%A ([_:list A]list A) (cons%%A x1 x2) ([y:A][_:list A]cons|A y) n)][H3:Eq%%A a x1][H4:Eq%%(list A) h (list_elim%%A ([_:list A]list A) (cons%%A c n) ([y:A][_:list A]cons|A y) x2)]Eq_subst%%(list A)%%(list_elim%%A ([_:list A]list A) (cons%%A c n) ([y:A][_:list A]cons|A y) x2)%%h (Eq_sym%%(list A)%%h%%(list_elim%%A ([_:list A]list A) (cons%%A c n) ([y:A][_:list A]cons|A y) x2) H4) ([z:list A]Perm%%A z j) (Eq_subst%%(list A)%%(list_elim%%A ([_:list A]list A) (cons%%A x1 x2) ([y:A][_:list A]cons|A y) n)%%j (Eq_sym%%(list A)%%j%%(list_elim%%A ([_:list A]list A) (cons%%A x1 x2) ([y:A][_:list A]cons|A y) n) H2) ([z:list A]Perm%%A (list_elim%%A ([_:list A]list A) (cons%%A c n) ([y:A][_:list A]cons|A y) x2) z) (Eq_subst%%A%%a%%c (Eq_sym%%A%%c%%a (Eq_sym%%A%%a%%c H1)) ([z:A]Perm%%A (append%%A x2 (cons%%A z n)) (append%%A n (cons%%A x1 x2))) (Eq_subst%%A%%x1%%a (Eq_sym%%A%%a%%x1 H3) ([z:A]Perm%%A (append%%A x2 (cons%%A z n)) (append%%A n (cons%%A x1 x2))) (symPerm%%A%%(append%%A n (cons%%A x1 x2))%%(append%%A x2 (cons%%A x1 n)) (transPerm%%A%%(append%%A n (cons%%A x1 x2))%%(append%%A (cons%%A x1 n) x2)%%(append%%A x2 (cons%%A x1 n)) (transPerm%%A%%(append%%A n (cons%%A x1 x2))%%(append%%A (cons%%A x1 x2) n)%%(append%%A (cons%%A x1 n) x2) (swapPerm%%A n (cons%%A x1 x2)) (consclPerm%%A x1%%(list_elim%%A ([_:list A]list A) n ([y:A][_:list A]cons|A y) x2)%%(list_elim%%A ([_:list A]list A) x2 ([y:A][_:list A]cons|A y) n) (swapPerm%%A x2 n))) (swapPerm%%A (cons%%A x1 n) x2))))))))) m1)) ([b|A][h,j|list A][cons_prem:Perm%%A h j][cons_ih:forallPerm h j][k,n:list A][eq1:Eq%%(list A) (cons%%A a k) (cons%%A b h)][eq2:Eq%%(list A) (cons%%A a n) (cons%%A b j)]cons_inj%%A%%a%%b%%k%%h eq1%%(Perm%%A k n) (cons_inj%%A%%a%%b%%n%%j eq2%%((Eq%%A a b)->(Eq%%(list A) k h)->Perm%%A k n) ([H1:Eq%%A a b][H2:Eq%%(list A) n j][H3:Eq%%A a b][H4:Eq%%(list A) k h]Eq_subst%%(list A)%%h%%k (Eq_sym%%(list A)%%k%%h H4) ([z:list A]Perm%%A z n) (Eq_subst%%(list A)%%j%%n (Eq_sym%%(list A)%%n%%j H2) ([z:list A]Perm%%A h z) cons_prem))))%%(cons%%A a l)%%(cons%%A a m) H l m (Eq_refl%%(list A) (cons%%A a l)) (Eq_refl%%(list A) (cons%%A a m))];
[hereditary : {A|Type(0)}{S:Rel (list A) (list A)}Prop
  = [A|Type(0)][S:Rel (list A) (list A)]{l:list A}SubRel%%(list A)%%(list A) (appcl%%A l S) S];
[heredPerm : {A|Type(0)}hereditary%%A (Perm%%A)
  = [A|Type(0)]list_elim%%A ([l:list A]SubRel%%(list A)%%(list A) (appcl%%A l (Perm%%A)) (Perm%%A)) ([x,y|list A][hyp:appcl%%A (nil A) (Perm%%A) x y]hyp) ([x1:A][x2:list A][x2_ih:SubRel%%(list A)%%(list A) (appcl%%A x2 (Perm%%A)) (Perm%%A)][x,y|list A][hyp:appcl%%A (cons%%A x1 x2) (Perm%%A) x y]x2_ih%%x%%y (heredPermlemma%%A x1%%(append%%A x2 x)%%(append%%A x2 y) hyp))];
[transposePerm : {A|Type(0)}{a,b|A}{l,m,n|list A}Perm%%A (insert%%A a l (insert%%A b m n)) (insert%%A b l (insert%%A a m n))
  = [A|Type(0)][a,b|A][l,m,n|list A]appclPerm%%A l%%(cons%%A a (insert%%A b m n))%%(cons%%A b (insert%%A a m n)) (transPerm%%A%%(cons%%A a (insert%%A b m n))%%(append%%A (cons%%A a n) (cons%%A b m))%%(cons%%A b (insert%%A a m n)) (consclPerm%%A a%%(insert%%A b m n)%%(list_elim%%A ([_:list A]list A) (cons%%A b m) ([y:A][_:list A]cons|A y) n) (transPerm%%A%%(insert%%A b m n)%%(append%%A (cons%%A b n) m)%%(list_elim%%A ([_:list A]list A) (cons%%A b m) ([y:A][_:list A]cons|A y) n) (swapPerm%%A m (cons%%A b n)) (transPerm%%A%%(append%%A (cons%%A b n) m)%%(append%%A (cons%%A b m) n)%%(list_elim%%A ([_:list A]list A) (cons%%A b m) ([y:A][_:list A]cons|A y) n) (consclPerm%%A b%%(list_elim%%A ([_:list A]list A) m ([y:A][_:list A]cons|A y) n)%%(list_elim%%A ([_:list A]list A) n ([y:A][_:list A]cons|A y) m) (swapPerm%%A n m)) (swapPerm%%A (cons%%A b m) n)))) (swapPerm%%A (cons%%A a n) (cons%%A b m)))];
