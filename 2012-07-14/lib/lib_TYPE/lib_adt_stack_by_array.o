Module lib_adt_stack_by_array Import "lib_nat_Lt" "lib_adt_stack" "lib_adt_array";
[refnSA : (Str ARRAY)->Str STACK
  = [A:Str ARRAY][domImpl=Prod (dom (Array A)) nat][eqImpl=[s,s':domImpl](Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s') /\ {i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s') i))][emptyImpl=Pr%%(dom (Array A))%%nat (newarray A) zero][pushImpl=[n:nat][arri:domImpl]Pr%%(dom (Array A))%%nat (assign A n (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) arri) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) arri)) (suc (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) arri))][popImpl=[arri:domImpl]Pr%%(dom (Array A))%%nat (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) arri) (pred (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) arri))][topImpl=[ai:domImpl]if_zero%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) ai) zero (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) ai) (pred (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) ai)))]make_Str_STACK (make_Setoid domImpl eqImpl) emptyImpl pushImpl popImpl topImpl];
[equivSTACK : {A:Str ARRAY}Equivalence%%(dom (Stack (refnSA A))) (eq|(Stack (refnSA A)))
  = [A:Str ARRAY]pair3%%(refl%%(dom (Stack (refnSA A))) (eq|(Stack (refnSA A))))%%(sym%%(dom (Stack (refnSA A))) (eq|(Stack (refnSA A))))%%(trans%%(dom (Stack (refnSA A))) (eq|(Stack (refnSA A)))) ([t:dom (Stack (refnSA A))]pair%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i)) (Eq_refl%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)) ([i:nat][H:Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)]Eq_refl%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i))) ([t,u|dom (Stack (refnSA A))][tu:eq|(Stack (refnSA A)) t u]pair%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i)) (Eq_subst%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (Eq_sym%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (fst%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i)) tu)) ([z:([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)]Eq%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) z) (Eq_refl%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))) ([i:nat][H:Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u)]Eq_sym%%nat%%(access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i)%%(access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i) (snd%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))%%({i'7:nat}(Lt i'7 (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i'7) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i'7)) tu i (Eq_subst%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (Eq_sym%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (fst%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))%%({i'7:nat}(Lt i'7 (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i'7) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i'7)) tu)) ([z:([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)]Lt i z) H)))) ([t,u,v|dom (Stack (refnSA A))][tu:eq|(Stack (refnSA A)) t u][uv:eq|(Stack (refnSA A)) u v]pair%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) v))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) v) i)) (Eq_subst%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (Eq_sym%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (fst%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i)) tu)) ([z:([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)]Eq%%nat z (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) v)) (fst%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) v))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) v) i)) uv)) ([i:nat][H:Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)]Eq_trans%%nat%%(access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i)%%(access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i)%%(access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) v) i) (snd%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))%%({i'9:nat}(Lt i'9 (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i'9) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i'9)) tu i H) (snd%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) v))%%({i'9:nat}(Lt i'9 (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i'9) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) v) i'9)) uv i (Eq_subst%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (Eq_sym%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (Eq_sym%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t))%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t)%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u) (fst%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) u))%%({i'9:nat}(Lt i'9 (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) t))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t) i'9) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) u) i'9)) tu))) ([z:([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) t)]Lt i z) H))))];
[axSTACK1 : {A:Str ARRAY}AxSTACK1 (refnSA A)
  = [A:Str ARRAY]pair%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A))))) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A)))) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (empty (refnSA A))))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A)))))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A)))) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (empty (refnSA A))) i)) (Eq_refl%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A))))) ([i:nat][H:Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A))))]not_n_Lt_zero i H (Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (empty (refnSA A)))) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (empty (refnSA A))) i)))];
[axSTACK2 : {A:Str ARRAY}AxSTACK2 (refnSA A)
  = [A:Str ARRAY]Eq_refl%%nat (top (refnSA A) (empty (refnSA A)))];
[axSTACK3 : {A:Str ARRAY}{ax_arrayA:Ax ARRAY A}AxSTACK3 (refnSA A)
  = [A:Str ARRAY][ax_arrayA:Ax ARRAY A]ax_arrayA%%({n:nat}{s:dom (Stack (refnSA A))}eq%%(Stack (refnSA A)) (pop (refnSA A) (push (refnSA A) n s)) s) ([H:EqARRAY A][H1:AxARRAY1 A][axA2:AxARRAY2 A][n:nat][s:dom (Stack (refnSA A))]pair%%(Eq%%(([_:dom (Array A)]nat) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s)))) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s))) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s))%%({i:nat}(Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s))))->Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s))) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) i)) (Eq_refl%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s)))) ([i:nat][H2:Lt i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s)))]axA2 n (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) i (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s)%%(Eq%%nat (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s))) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) i)) ([H3:(Eq%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) i)->Eq%%nat (access A (assign A n (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)) i) n][H4:(not (Eq%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) i))->Eq%%nat (access A (assign A n (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)) i) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) i)]H4 ([H5:Eq%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) i]Lt_not_Eq i (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) (pop (refnSA A) (push (refnSA A) n s))) H2 (Eq_sym%%nat%%(sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)%%i H5)))))];
[axSTACK4 : {A:Str ARRAY}{ax_arrayA:Ax ARRAY A}AxSTACK4 (refnSA A)
  = [A:Str ARRAY][ax_arrayA:Ax ARRAY A]ax_arrayA%%({n:nat}{s:dom (Stack (refnSA A))}Eq%%nat (top (refnSA A) (push (refnSA A) n s)) n) ([H:EqARRAY A][H1:AxARRAY1 A][axA2:AxARRAY2 A][n:nat][s:dom (Stack (refnSA A))]axA2 n (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s)%%(Eq%%nat (top (refnSA A) (push (refnSA A) n s)) n) ([H2:(Eq%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s))->Eq%%nat (access A (assign A n (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)) n][H3:(not (Eq%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)))->Eq%%nat (access A (assign A n (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s)) (access A (sig_pi1%%(dom (Array A))%%([_:dom (Array A)]nat) s) (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s))]H2 (Eq_refl%%nat (sig_pi2%%(dom (Array A))%%([_:dom (Array A)]nat) s))))];
[sat_refnSA : Sat%%STACK%%ARRAY refnSA
  = [A:Str ARRAY][ax_arrayA:Ax ARRAY A]pair5%%(EqSTACK (refnSA A))%%(AxSTACK1 (refnSA A))%%(AxSTACK2 (refnSA A))%%(AxSTACK3 (refnSA A))%%(AxSTACK4 (refnSA A)) (equivSTACK A) (axSTACK1 A) (axSTACK2 A) (axSTACK3 A ax_arrayA) (axSTACK4 A ax_arrayA)];
